<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="QSnowy">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="QSnowy">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="QSnowy">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>QSnowy</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">QSnowy</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ä»£ç ä¼šè¯´è¯</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/26/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BAGithubPage%E5%8D%9A%E5%AE%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/26/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BAGithubPage%E5%8D%9A%E5%AE%A2/" class="post-title-link" itemprop="url">ä½¿ç”¨hexoæ­å»ºGithubPageåšå®¢</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-26 08:19:50 / ä¿®æ”¹æ—¶é—´ï¼š05:59:05" itemprop="dateCreated datePublished" datetime="2020-04-26T08:19:50+00:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>æ˜¯ä¸€ä¸ªåŸºäº<a href="https://nodejs.org/" target="_blank" rel="noopener">Node.js</a>çš„é«˜æ•ˆé™æ€ç½‘ç«™ç”Ÿæˆæ¡†æ¶ï¼Œä½¿ä½ å¯ä»¥ä¸“æ³¨äºMarkDownæ–‡æ¡£å†…å®¹çš„ç¼–å†™ï¼Œå…¶ä»–çš„ç½‘ç«™èµ„æºç”Ÿæˆäº¤ç»™Hexoå°±è¡Œäº†ã€‚æˆ‘ä¸»è¦è®²ä¸€è®²è‡ªå·±æ˜¯å¦‚ä½•åœ¨Macä¸Šé¢ä½¿ç”¨Hexoç¼–å†™åšå®¢çš„ã€‚</p>
<h3 id="åˆ›å»ºåšå®¢"><a href="#åˆ›å»ºåšå®¢" class="headerlink" title="åˆ›å»ºåšå®¢"></a>åˆ›å»ºåšå®¢</h3><p>é¦–å…ˆä½ å¾—å®‰è£…<a href="https://nodejs.org/" target="_blank" rel="noopener">Node.js</a>å’Œ<a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a>ï¼Œä¸è¿‡Macé‡Œé¢é»˜è®¤è‡ªå¸¦Gitçš„ï¼Œä¸ç”¨é‡å¤å®‰è£…äº†ã€‚Nodeç¯å¢ƒï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯<a href="https://brew.sh/index_zh-cn" target="_blank" rel="noopener">Homebrew</a>å®‰è£…çš„</p>
<p>ç›´æ¥ç»ˆç«¯é‡Œè¾“å…¥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure>

<p>å®‰è£…Hexo</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°åˆ›å»ºåšå®¢ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init &lt;blog directory&gt;</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥åšå®¢ç›®å½•ï¼Œè¿è¡Œå¯åŠ¨æœåŠ¡å™¨å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo serve</span><br><span class="line">// ä¹Ÿå¯ä»¥ç®€å†™ä¸º hexo s</span><br></pre></td></tr></table></figure>

<p>ä¹‹åç»ˆç«¯ä¼šè¾“å‡ºä»¥ä¸‹ä¿¡æ¯</p>
<blockquote>
<p> INFO  Start processing<br> INFO  Hexo is running at <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> . Press Ctrl+C to stop.</p>
</blockquote>
<p>è¡¨æ˜åšå®¢å·²ç»è¿è¡Œåœ¨<a href="http://localhost:4000" target="_blank" rel="noopener">æœ¬åœ°</a>äº†ï¼Œæµè§ˆå™¨æ‰“å¼€ç½‘å€å°±èƒ½çœ‹åˆ°æ•ˆæœï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚</p>
<h3 id="éƒ¨ç½²åšå®¢åˆ°GithubPages"><a href="#éƒ¨ç½²åšå®¢åˆ°GithubPages" class="headerlink" title="éƒ¨ç½²åšå®¢åˆ°GithubPages"></a>éƒ¨ç½²åšå®¢åˆ°GithubPages</h3><p>ä¸‹é¢æˆ‘ä»¬å°±è¦æŠŠè‡ªå·±çš„åšå®¢éƒ¨ç½²åˆ°<a href="https://github.com" target="_blank" rel="noopener">GitHubPages</a>ï¼Œé¦–å…ˆä½ å¾—æœ‰ä¸ªGitHubäº¤å‹è´¦å·ï¼Œè¿™é‡Œé»˜è®¤å„ä½å·²ç»æœ‰äº†ã€‚æˆ‘ä»¬å»GitHubä¸Šé¢åˆ›å»ºä¸€ä¸ªrepositoryï¼Œåå­—è¦è¿™ä¸ªæ ·å¼çš„ï¼š<code>&lt;yourname&gt;.github.io</code>ï¼Œå› ä¸ºGitHubPagesä¼šé»˜è®¤è¯»å–è¿™ä¸ªåå­—çš„ä»“åº“ã€‚</p>
<p>å®‰è£…éƒ¨ç½²gitçš„æ’ä»¶</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®ä¸€ä¸‹ç«™ç‚¹é…ç½®æ–‡ä»¶<code>_config.yml</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: 'your repository address' # è‡ªå·±çš„GitHubä»“åº“åœ°å€</span><br><span class="line">  branch: master # æŒ‡å®šä¸€ä¸‹ è¦æ”¾éƒ¨ç½²åšå®¢çš„åˆ†æ”¯</span><br></pre></td></tr></table></figure>

<p>ä¸€é”®éƒ¨ç½²</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br><span class="line">// å¯ä»¥ç®€å†™ä¸º hexo d</span><br></pre></td></tr></table></figure>

<p>ç­‰å‡ åˆ†é’Ÿï¼Œå»æµè§ˆå™¨æ‰“å¼€ <code>&lt;yourname&gt;.github.io</code> å°±èƒ½çœ‹åˆ°è‡ªå·±çš„åšå®¢äº†ã€‚</p>
<h3 id="åˆ©ç”¨Travisè‡ªåŠ¨éƒ¨ç½²"><a href="#åˆ©ç”¨Travisè‡ªåŠ¨éƒ¨ç½²" class="headerlink" title="åˆ©ç”¨Travisè‡ªåŠ¨éƒ¨ç½²"></a>åˆ©ç”¨Travisè‡ªåŠ¨éƒ¨ç½²</h3><p>è¿˜æƒ³æ›´ç®€å•å—ï¼Œåªç”¨pushæ–‡ç« åˆ°GitHubï¼Œç„¶åè‡ªåŠ¨éƒ¨ç½²åˆ°GitHubPagesï¼Ÿ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/05/2019%E5%85%A5%E6%88%B7%E5%B9%BF%E5%B7%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/07/05/2019%E5%85%A5%E6%88%B7%E5%B9%BF%E5%B7%9E/" class="post-title-link" itemprop="url">2019å¹¿å·å­¦å†å…¥æˆ·äº²èº«ç»å†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-07-05 00:00:00" itemprop="dateCreated datePublished" datetime="2019-07-05T00:00:00+00:00">2019-07-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:04" itemprop="dateModified" datetime="2020-04-26T05:59:04+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/" itemprop="url" rel="index"><span itemprop="name">ç”Ÿæ´»çäº‹</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ˜¨å¤©æŠŠå…¥æˆ·ææ–™é€’äº¤ç»™äººæ‰æ¸¯ï¼Œç®—æ˜¯è¿ˆå‡ºå…¥æˆ·æµç¨‹ä¸€å°æ­¥ã€‚è™½ç„¶è¿˜æ²¡æœ‰çœŸæ­£æ‹¿åˆ°å¹¿å·æˆ·å£ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æœ‰å¿…è¦å…ˆåˆ†äº«ä¸€ä¸‹è‡ªå·±çš„ç»éªŒï¼Œæ¯•ç«Ÿæˆ‘ä¹Ÿæ˜¯ä»ç½‘ä¸ŠæŸ¥äº†å¾ˆå¤šèµ„æ–™è¸©äº†å¾ˆå¤šå‘ã€‚<br>ç”±äºæˆ‘åŠç†çš„å­¦å†å¼•è¿›ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œå°±åªè¯´ä¸€ä¸‹å­¦å†å¼•è¿›çš„æµç¨‹ã€‚</p>
<h3 id="å…¥æˆ·æµç¨‹"><a href="#å…¥æˆ·æµç¨‹" class="headerlink" title="å…¥æˆ·æµç¨‹"></a>å…¥æˆ·æµç¨‹</h3><p>å…ˆåˆ°<a href="https://www.gdzwfw.gov.cn/" target="_blank" rel="noopener">å¹¿ä¸œæ”¿åŠ¡ç½‘</a>æœä¸€ä¸‹æœ€æ–°çš„<code>äººæ‰å¼•è¿›</code>æ”¿ç­–ï¼Œä¼šçœ‹åˆ°ç›¸åº”çš„åŠç†æŒ‡å—ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹å¹¿ä¸œçš„æ”¿åºœç½‘ç«™è¿˜æ˜¯æŒºæœ‰ç”¨çš„ã€‚æ•´ä¸ªæµç¨‹å°±å¦‚ä¸‹å›¾ä¸€æ ·<br><img src="../assets/images/%E4%BA%BA%E6%89%8D%E5%BC%95%E8%BF%9B%E6%B5%81%E7%A8%8B.png" alt=""></p>
<h3 id="ææ–™å‡†å¤‡"><a href="#ææ–™å‡†å¤‡" class="headerlink" title="ææ–™å‡†å¤‡"></a>ææ–™å‡†å¤‡</h3><p>åœ¨æ”¿åºœç½‘ç«™çœ‹åˆ°çš„æŒ‡å—ä¸­ï¼Œä¼šæ˜ç¡®è¯´æ˜éœ€è¦å‡†å¤‡å“ªäº›ææ–™ï¼Œä¸‹é¢æˆ‘åˆ—ä¸€ä¸ªå…·ä½“çš„æ¸…å•ï¼š</p>
<ul>
<li>å¹¿å·å¸‚å¼•è¿›äººæ‰ç”³æŠ¥è¡¨ï¼Œè¿™ä¸ªè¡¨éœ€è¦åœ¨<a href="http://gzrsj.hrssgz.gov.cn/vsgzhr/PersonalPortal/home.aspx?TOKENID=L0U1b2N2aEtuMFlEaWRlUldxUEVpUT09&RESID=null" target="_blank" rel="noopener">æ™ºæ…§äººæ‰å®¶å›­</a>å¡«å†™èµ„æ–™(è¿™ä¸ªç½‘å€æˆ‘æœäº†å¤§åŠå¤©æ‰æ‰¾åˆ°ğŸ˜…)ï¼Œä¸Šä¼ ç›¸åº”çš„å›¾ç‰‡é™„ä»¶ã€‚ç„¶åæ‰“å°ä¸€ä»½(ä¸€ä»½å°±å¤Ÿäº†)ï¼Œäº¤ç»™å•ä½ç­¾å­—ç›–ç« ã€‚è®°å¾—ç­¾å­—å“Ÿï¼Œå®¡æ ¸äººå‘˜çœ‹æˆ‘çš„æ–‡ä»¶åªæœ‰å…¬ç« ï¼Œå½“åœºè®©æˆ‘ç”¨å¦ä¸€ç§æ‰‹æ³•å†™ä¸ŠåŒæ„å’Œå¹´æœˆæ—¥ğŸ˜‚</li>
<li>æˆ·å£ç°¿æˆ·ä¸»é¡µå’Œæœ¬äººé¡µï¼Œè¿™ä¸ªå¤å°ä¸€ä»½ï¼Œç›–ä¸Šå•ä½å…¬ç« ã€‚</li>
<li>è½æˆ·åœ°å€ææ–™ï¼Œç”±äºæœ¬äººå¹¿å·æ²¡æˆ¿ï¼Œæä¾›äº†ä¸€ä»½ã€Šè½æˆ·å…¬å…±é›†ä½“æˆ·ç”³è¯·ä¹¦ã€‹ï¼Œæ¨¡æ¿ç½‘ä¸Šæœ‰ï¼Œæ‰“å°ä¸‹æ¥ï¼Œè‡ªå·±ç­¾å­—æŒ‰æŒ‡æ¨¡å°±è¡Œäº†ä¸éœ€è¦å•ä½ç›–ç« ã€‚è¿™é‡Œè¦å¤šè¯´ä¸€å¥ï¼Œå•ä½åœ°å€æ‰€å±è¡—é“ï¼Œä¸Š<a href="https://lbs.amap.com/api/javascript-api/example/geocoder/regeocoding" target="_blank" rel="noopener">é«˜å¾·åœ°å›¾API</a>æŸ¥ä¸€ä¸‹å°±å‡ºæ¥äº†ã€‚</li>
<li>æ¯•ä¸šè¯å¤å°ä»¶åŠå­¦ä¿¡ç½‘è®¤è¯è¯ä¹¦ï¼Œå»<a href="https://my.chsi.com.cn/archive/bab/index.action" target="_blank" rel="noopener">å­¦ä¿¡ç½‘</a>æ‰“å°è®¤è¯è¯ä¹¦ï¼Œéœ€è¦å•ä½ç›–ç« ã€‚</li>
<li>å­¦ä½è¯å¤å°ä»¶åŠå­¦å†è®¤è¯è¯ä¹¦ï¼Œåœ¨<a href="https://www.chinadegrees.cn/cqva/personal/index.html" target="_blank" rel="noopener">å­¦å†ç½‘</a>æ‰“å°å­¦å†è®¤è¯è¯ä¹¦ï¼Œéœ€è¦å•ä½ç›–ç« ã€‚</li>
</ul>
<p>æˆ‘æ˜¯å¹¿å·å‚åŠ çš„ç¤¾ä¿ï¼Œæ‰€ä»¥ä¸ç”¨å‡†å¤‡ç¤¾ä¿ç¼´è´¹å†å²æ˜ç»†ã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œéœ€è¦æä¾›çœå‚ä¿å†å²ç¼´è´¹æ˜ç»†çš„ã€‚<br>æŠŠä¸Šé¢çš„ææ–™å‡†å¤‡é½å…¨ï¼Œç„¶åå»<a href="http://www.thnet.gov.cn/thxxw/zwe_lcfb/zwe_nry.shtml" target="_blank" rel="noopener">å¤©æ²³æ”¿åŠ¡</a>é¢„çº¦ï¼Œè¯è¯´è¿™ä¸ªé¢„çº¦æŒºéš¾çš„ï¼Œæ¯ä¸ªå·¥ä½œæ—¥9ç‚¹æ”¾å·ï¼Œéœ€è¦è¹²ç‚¹æŠ¢å·ã€‚</p>
<h3 id="å…¥æˆ·ææ–™é€’äº¤"><a href="#å…¥æˆ·ææ–™é€’äº¤" class="headerlink" title="å…¥æˆ·ææ–™é€’äº¤"></a>å…¥æˆ·ææ–™é€’äº¤</h3><p>è¿™ä¸ªå°±æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œå¸¦ä¸Š<code>ç”³æŠ¥è¡¨</code>ã€<code>æˆ·å£ç°¿åŸä»¶å’Œå¤å°ä»¶</code>ã€<code>è½æˆ·åœ°å€ææ–™</code>ã€<code>æ¯•ä¸šè¯åŸä»¶å’Œå¤å°ä»¶</code>ã€<code>å­¦ä½è¯åŸä»¶å’Œå¤å°ä»¶</code>ã€<code>å­¦å†è®¤è¯è¯ä¹¦</code>ã€<code>å­¦ä½è®¤è¯è¯ä¹¦</code>ï¼Œå»ç°åœºå–å·åŠç†å°±è¡Œäº†ï¼Œå…¶å®è¿™ä¸€æ­¥å°±æ˜¯äººå·¥å¤æ ¸èµ„æ–™æ˜¯å¦å±å®ï¼Œç°åœºä¼šç»™ä¸€å †æ–‡ä»¶ç­¾å­—ç¡®è®¤çš„ã€‚</p>
<h3 id="æˆ·å£è¿ç§»"><a href="#æˆ·å£è¿ç§»" class="headerlink" title="æˆ·å£è¿ç§»"></a>æˆ·å£è¿ç§»</h3><p>å…¥æˆ·èµ„æ–™é€’äº¤åï¼Œå¤§çº¦ä¸€ä¸ªæœˆåå°±ä¼šæœ‰æ‰¹å¤ç»“æœäº†ï¼Œç­‰å¾…æœŸé—´å¯ä»¥åˆ°å¹¿å·äººç¤¾å±€ç½‘ç«™<a href="http://gzrsj.hrssgz.gov.cn/vsgzpiapp01/GZPI/Gateway/PersonIntroducePublicity.aspx" target="_blank" rel="noopener">äººæ‰å¼•è¿›å…¬ç¤ºåå•</a>é‡ŒæŸ¥çœ‹è‡ªå·±æ˜¯å¦é€šè¿‡å®¡æ ¸ã€‚</p>
<p>çœ‹åˆ°è‡ªå·±åœ¨å…¬ç¤ºåå•ä¸­ï¼Œå…¬ç¤ºä¸€å‘¨åå°±ä¼šæ”¶åˆ°äººç¤¾å±€çš„æ‰¹å¤æ–‡ä»¶å’Œäººæ‰å¡ã€‚å¦‚æœæ˜¯å¹¿ä¸œçœå†…æˆ·ç±ï¼Œç›´æ¥å»å¹¿å·çš„å…¬å®‰æˆ·æ”¿çª—å£åŠç†æ‰‹ç»­å°±å¯ä»¥ã€‚å¦‚æœæ˜¯çœå¤–æˆ·ç±çš„è¯ï¼Œéœ€è¦è‡ªå·±(å¯ä»¥æ‰¾äººä»£åŠ)æ‹¿ç€æˆ·å£å‡†è¿è¯ï¼Œå…ˆå›è€å®¶åŠç†æˆ·å£è¿å‡ºï¼Œç„¶åæ‹¿ç€è€å®¶çš„<code>æˆ·å£è¿å‡ºè¯</code>ã€<code>èº«ä»½è¯</code>ã€<code>å‡†è¿è¯</code>ã€<code>å…¬å¸è¥ä¸šæ‰§ç…§å‰¯æœ¬</code>ã€<code>äººæ‰å¡</code>åˆ°å¹¿å·è¿™è¾¹æˆ·æ”¿çª—å£åŠç†è¿å…¥æ‰‹ç»­ã€‚åŒæ ·ä¹Ÿæ˜¯è¦åœ¨<a href="http://www.thnet.gov.cn/thxxw/zwe_lcfb/zwe_nry.shtml" target="_blank" rel="noopener">å¤©æ²³æ”¿åŠ¡</a>ä¸Šé¢é¢„çº¦çš„ã€‚</p>
<p>åŠç†å¹¿å·å…¥æˆ·åï¼Œå¯ä»¥ç›´æ¥åœ¨æˆ·æ”¿çª—å£ç”³é¢†æ–°èº«ä»½è¯ï¼Œæ—§èº«ä»½è¯å¯ä»¥è‡ªå·±ä¿ç•™ã€‚ç°åœºå‡ºæœ¬äººæˆ·å£æœ¬é¡µï¼Œç”±äºè¿å…¥çš„æ˜¯è¡—é“é›†ä½“æˆ·ï¼Œæœ¬äººé¡µä¸èƒ½ä¿ç®¡åªèƒ½è‡ªå·±å…ˆæ‹ç…§è®°å½•ä¸€ä¸‹ã€‚</p>
<p>è‡³æ­¤ï¼Œå…¥æˆ·å¹¿å·çš„æµç¨‹ç®—æ˜¯åŠå®Œäº†ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/07/sdwebimage-structure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/07/sdwebimage-structure/" class="post-title-link" itemprop="url">SDWebImageä»£ç è§£æ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-07 00:00:00" itemprop="dateCreated datePublished" datetime="2019-03-07T00:00:00+00:00">2019-03-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:05" itemprop="dateModified" datetime="2020-04-26T05:59:05+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>SDWebImageæ˜¯GitHubä¸Šé¢ä¸€ä¸ªå¾ˆç«çš„iOSå’ŒMacOSå¹³å°ä¸‹ï¼Œå›¾ç‰‡ä¸‹è½½ã€åŠ è½½ã€ç®¡ç†å¼€å‘ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<p>æ•´ä¸ªæºç å¤§æ¦‚åˆ†ä¸ºï¼šå›¾ç‰‡ç®¡ç†ã€ä¸‹è½½å™¨ã€ä¸‹è½½ä»»åŠ¡ã€ç¼“å­˜ã€ç¼–ç è§£ç ã€UIå±•ç¤ºå‡ ä¸ªæ¨¡å—ã€‚</p>
<ul>
<li>å›¾ç‰‡ç®¡ç†ï¼šSDWebImageManager</li>
<li>ä¸‹è½½å™¨ï¼šSDWebImageDownloader</li>
<li>ä¸‹è½½ä»»åŠ¡ï¼šSDWebImageDownloaderOperation</li>
<li>ç¼“å­˜ï¼šSDWebImageCache</li>
<li>è§£ç ï¼šSDWebImageIOCoderã€SDWebImageGIFCoder</li>
<li>UIå±•ç¤ºï¼šUIImageView+WebCache ç­‰</li>
<li>é…ç½®å…¶ä»–ï¼šSDImageCacheConfigç­‰</li>
</ul>
<p><strong>å…ˆè¯´ä¸€ä¸‹ï¼Œæ•´ä½“çš„å›¾ç‰‡ä¸‹è½½æµç¨‹ï¼š</strong><br>ç»™å®šä¸€ä¸ªURLç»™<code>Manager</code>åï¼Œä¼šå…ˆç”¨<code>Cache</code>æ£€æµ‹æ˜¯å¦æœ‰å¯¹åº”çš„ç¼“å­˜å›¾ç‰‡ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜ä¸”éœ€è¦ä¸‹è½½ï¼Œ<code>Manager</code>æŒæœ‰çš„<code>Downloader</code>ä¼šç”Ÿæˆä¸€ä¸ª<code>URLSession</code>ï¼Œå°†<code>URL</code>è½¬åŒ–ä¸ºä¸€ä¸ª<code>Request</code>ï¼Œç„¶åæŠŠ<code>Request</code>å’Œ<code>URLSession</code>åŒ…è£…åœ¨<code>Operation</code>ä¸­ï¼Œå°†<code>Operation</code>åŠ å…¥åˆ°è‡ªå·±çš„<code>ä¸‹è½½é˜Ÿåˆ—</code>ä¸­ï¼Œå¼€å§‹æ‰§è¡Œä¸‹è½½ä»»åŠ¡ï¼›ä»»åŠ¡å®Œæˆæˆ–è€…å¼‚å¸¸ï¼Œç»è¿‡<code>ç³»ç»Ÿçš„Requestä»£ç†</code>å›è°ƒï¼Œæ‹¿åˆ°å›¾ç‰‡æ•°æ®æˆ–å¼‚å¸¸ï¼Œé€šè¿‡<code>Coder</code>å°†æ•°æ®è§£å‹ä¸ºå›¾ç‰‡ï¼Œåˆ©ç”¨<code>Cache</code>ç¼“å­˜åœ¨å†…å­˜å’Œç£ç›˜ä¸­ï¼Œé€šè¿‡<code>blockå›è°ƒ</code>ç»™åˆ°ä¸»çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚</p>
<h3 id="å›¾ç‰‡ç®¡ç†"><a href="#å›¾ç‰‡ç®¡ç†" class="headerlink" title="å›¾ç‰‡ç®¡ç†"></a>å›¾ç‰‡ç®¡ç†</h3><p>é‡‡ç”¨å•ä¾‹æ¨¡å¼ï¼Œåˆå§‹åŒ–åé»˜è®¤ä¼šæŒæœ‰<code>SDWebImageCache</code>å’Œ<code>SDWebImageDownloader</code>ä¸¤ä¸ªå®ä¾‹ï¼Œä¾¿äºè¿›è¡Œå›¾ç‰‡ç¼“å­˜å’Œä¸‹è½½ç®¡ç†ã€‚ä¸è¿‡ç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è‡ªè¡ŒæŒ‡å®š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (nonnull instancetype)initWithCache:(nonnull <span class="type">SDImageCache</span> *)cache downloader:(nonnull <span class="type">SDWebImageDownloader</span> *)downloader</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶æä¾›ä»£ç†æ–¹æ³•ï¼Œä¸ºç”¨æˆ·æä¾›URLè¿‡æ»¤åŠŸèƒ½ï¼Œéœ€è¦è‡ªå·±å®ç°ä»£ç†æ–¹æ³•ã€‚</p>
<h4 id="å¸¸ç”¨æ–¹æ³•ï¼š"><a href="#å¸¸ç”¨æ–¹æ³•ï¼š" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ï¼š"></a>å¸¸ç”¨æ–¹æ³•ï¼š</h4><p>ä½¿ç”¨Manangerä¸‹è½½æŒ‡å®šURLå›¾ç‰‡ï¼Œç›‘å¬ä¸‹è½½è¿›åº¦ï¼Œå®Œæˆå›è°ƒï¼Œè¿”å›ä¸€ä¸ªå¯å–æ¶ˆçš„ä¸‹è½½ä»»åŠ¡ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (nullable id &lt;<span class="type">SDWebImageOperation</span>&gt;)loadImageWithURL:(nullable <span class="type">NSURL</span> *)url</span><br><span class="line">                                              options:(<span class="type">SDWebImageOptions</span>)options</span><br><span class="line">                                             progress:(nullable <span class="type">SDWebImageDownloaderProgressBlock</span>)progressBlock</span><br><span class="line">                                            completed:(nullable <span class="type">SDInternalCompletionBlock</span>)completedBlock;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‹è½½å™¨"><a href="#ä¸‹è½½å™¨" class="headerlink" title="ä¸‹è½½å™¨"></a>ä¸‹è½½å™¨</h3><p>é‡‡ç”¨å•ä¾‹æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šURLSessionConfigurationï¼Œæ‰€æœ‰URLè¯·æ±‚éƒ½ä¼šä½¿ç”¨è¿™ä¸€ä¸ªsessioné…ç½®ã€‚</p>
<h4 id="å¸¸ç”¨æ–¹æ³•ï¼š-1"><a href="#å¸¸ç”¨æ–¹æ³•ï¼š-1" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ï¼š"></a>å¸¸ç”¨æ–¹æ³•ï¼š</h4><p>æŒ‡å®šsessioné…ç½®</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (nonnull instancetype)initWithSessionConfiguration:(nullable <span class="type">NSURLSessionConfiguration</span> *)sessionConfiguration</span><br></pre></td></tr></table></figure>
<p>å¼€å§‹ä¸€ä¸ªURLä¸‹è½½è¯·æ±‚ï¼Œç›‘å¬è¿›åº¦ï¼Œå®Œæˆå›è°ƒï¼Œè¿”å›ä¸€ä¸ªä¸‹è½½Tokenï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è¿™ä¸ªTokenå–æ¶ˆä¸‹è½½ã€‚ä¸€ä¸ªURLä¼šäº§ç”Ÿä¸€ä¸ªOperationï¼ŒåŠ å…¥ä¸‹è½½é˜Ÿåˆ—ï¼Œè¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (nullable <span class="type">SDWebImageDownloadToken</span> *)downloadImageWithURL:(nullable <span class="type">NSURL</span> *)url</span><br><span class="line">                                                   options:(<span class="type">SDWebImageDownloaderOptions</span>)options</span><br><span class="line">                                                  progress:(nullable <span class="type">SDWebImageDownloaderProgressBlock</span>)progressBlock</span><br><span class="line">                                                 completed:(nullable <span class="type">SDWebImageDownloaderCompletedBlock</span>)completedBlock</span><br></pre></td></tr></table></figure>

<p>å–æ¶ˆä¸€ä¸ªä¸‹è½½ä»»åŠ¡</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)cancel:(nullable <span class="type">SDWebImageDownloadToken</span> *)token</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‹è½½ä»»åŠ¡"><a href="#ä¸‹è½½ä»»åŠ¡" class="headerlink" title="ä¸‹è½½ä»»åŠ¡"></a>ä¸‹è½½ä»»åŠ¡</h3><p>è¿™é‡Œé¢å®šä¹‰äº†ä¸€ä¸ªä»»åŠ¡å¯äº¤äº’çš„åè®®ï¼Œ<code>SDWebImageDownloaderOperationInterface</code>ï¼Œåè®®è§„å®šäº†ä»»åŠ¡çš„åˆå§‹åŒ–æ–¹æ³•ã€æ·»åŠ ä»»åŠ¡è¿›åº¦å’Œå®Œæˆçš„å›è°ƒçš„æ–¹æ³•ã€ä»»åŠ¡çš„å–æ¶ˆæ–¹æ³•ä»¥åŠè¯ä¹¦çš„æ·»åŠ ã€‚ä»»åŠ¡ç»§æ‰¿ä¸NSOperationï¼Œä¸€ä¸ªè¯·æ±‚å¯¹åº”äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ä¼šæ”¾åœ¨ä¸‹è½½ç®¡ç†å•ä¾‹ä¸­çš„ä¸€ä¸ªä¸‹è½½é˜Ÿåˆ—ä¸­ï¼Œå¯ä»¥æŒ‰å…ˆå…¥å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æŒ‰å †æ ˆçš„åå…¥å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œã€‚</p>
<p>ä»»åŠ¡åœ¨æ”¶åˆ°è¯·æ±‚å›åº”åï¼Œä¼šå°†æ¥å—åˆ°çš„å›¾ç‰‡æ•°æ®è§£ç æˆä¸ºUIImageå¯¹è±¡ï¼Œå†é€šè¿‡Blockè¿›è¡Œå›è°ƒç»™ä¸»çº¿ç¨‹ã€‚</p>
<h4 id="å¸¸ç”¨æ–¹æ³•ï¼š-2"><a href="#å¸¸ç”¨æ–¹æ³•ï¼š-2" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ï¼š"></a>å¸¸ç”¨æ–¹æ³•ï¼š</h4><p>åˆå§‹åŒ–ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™æ˜¯ä¸€ä¸ªå®ç°çš„åè®®æ–¹æ³•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (nonnull instancetype)initWithRequest:(nullable <span class="type">NSURLRequest</span> *)request</span><br><span class="line">                              inSession:(nullable <span class="type">NSURLSession</span> *)session</span><br><span class="line">                                options:(<span class="type">SDWebImageDownloaderOptions</span>)options</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ä»»åŠ¡è¿›åº¦å›è°ƒ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (nullable id)addHandlersForProgress:(nullable <span class="type">SDWebImageDownloaderProgressBlock</span>)progressBlock</span><br><span class="line">                            completed:(nullable <span class="type">SDWebImageDownloaderCompletedBlock</span>)completedBlock</span><br></pre></td></tr></table></figure>

<h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><p>é€šè¿‡è¿™ä¸ªæ¨¡å—ï¼Œå°†ä¸‹è½½å®Œæˆçš„å›¾ç‰‡ï¼Œå­˜å‚¨åˆ°å†…å­˜æˆ–è€…ç£ç›˜ä¸­ã€‚åŒæ ·æ˜¯å•ä¾‹æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šç¼“å­˜è·¯å¾„ã€‚ä½¿ç”¨äº†<code>SDMemoryCache:NSCache</code>è¿›è¡Œå†…å­˜å­˜å‚¨ï¼Œå†…éƒ¨ä½¿ç”¨äº†<code>NSMapTable&lt;KeyType, ObjectType&gt; *weakCache</code>è¿™ä¸ªå±æ€§è¿›è¡Œå®é™…çš„å†…å­˜å­˜å‚¨å·¥ä½œã€‚</p>
<h4 id="å¸¸ç”¨æ–¹æ³•ï¼š-3"><a href="#å¸¸ç”¨æ–¹æ³•ï¼š-3" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ï¼š"></a>å¸¸ç”¨æ–¹æ³•ï¼š</h4><p>æŒ‡å®šç¼“å­˜è·¯å¾„</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (nonnull instancetype)initWithNamespace:(nonnull <span class="type">NSString</span> *)ns</span><br><span class="line">                       diskCacheDirectory:(nonnull <span class="type">NSString</span> *)directory</span><br></pre></td></tr></table></figure>
<p>å­˜å‚¨å›¾ç‰‡åˆ°å†…å­˜æˆ–è€…ç£ç›˜ï¼Œå›¾ç‰‡é€šè¿‡ç¼–ç å·¥å…·è½¬ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œæœ€ç»ˆå­˜å‚¨åœ¨ç£ç›˜ä¸­ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)storeImage:(nullable <span class="type">UIImage</span> *)image</span><br><span class="line">         imageData:(nullable <span class="type">NSData</span> *)imageData</span><br><span class="line">            forKey:(nullable <span class="type">NSString</span> *)key</span><br><span class="line">            toDisk:(<span class="type">BOOL</span>)toDisk</span><br><span class="line">        completion:(nullable <span class="type">SDWebImageNoParamsBlock</span>)completionBlock</span><br></pre></td></tr></table></figure>
<p>ä»å†…å­˜æˆ–è€…ç£ç›˜ä¸­æ‰¾åˆ°ä¸keyå¯¹åº”çš„å›¾ç‰‡</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (nullable <span class="type">UIImage</span> *)imageFromCacheForKey:(nullable <span class="type">NSString</span> *)key;</span><br></pre></td></tr></table></figure>

<p>æ¸…é™¤å†…å­˜å’Œç£ç›˜ç¼“å­˜</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (void)clearMemory;</span><br><span class="line">- (void)clearDiskOnCompletion:(nullable <span class="type">SDWebImageNoParamsBlock</span>)completion;</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–ç è§£ç "><a href="#ç¼–ç è§£ç " class="headerlink" title="ç¼–ç è§£ç "></a>ç¼–ç è§£ç </h3><p>æ¡†æ¶ä¸­æœ‰IOCoderå’ŒGIFCoderï¼Œæˆ‘è¿™é‡Œåªå±•ç¤ºIOCoderï¼Œä¸‹è½½å®Œçš„å›¾ç‰‡ä¼šé€šè¿‡è½¬åŒ–ä¸ºNSDataï¼ŒåŒæ—¶ä»ç½‘ç»œè·å–çš„æ•°æ®ä¹Ÿä¼šè¢«è§£ç è½¬åŒ–ä¸ºimageã€‚</p>
<h4 id="å…³é”®æ–¹æ³•ï¼š"><a href="#å…³é”®æ–¹æ³•ï¼š" class="headerlink" title="å…³é”®æ–¹æ³•ï¼š"></a>å…³é”®æ–¹æ³•ï¼š</h4><p>å°†å›¾ç‰‡æ ¹æ®ä¸åŒçš„å›¾ç‰‡æ ¼å¼ï¼Œè½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">NSData</span> *)encodedDataWithImage:(<span class="type">UIImage</span> *)image format:(<span class="type">SDImageFormat</span>)format&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å›¾ç‰‡æ ¼å¼ï¼Œæœ€åä¼šä¿å­˜ä¸ºPNGæˆ–è€…JPEGæ ¼å¼ï¼Œè¿™é‡Œçœç•¥äº†ä¸€äº›æºç </span></span><br><span class="line">    <span class="type">NSMutableData</span> *imageData = [<span class="type">NSMutableData</span> data];</span><br><span class="line">    <span class="type">CFStringRef</span> imageUTType = [<span class="type">NSData</span> sd_UTTypeFromSDImageFormat:format];</span><br><span class="line">    <span class="comment">// åˆ›å»º image destination.</span></span><br><span class="line">    <span class="type">CGImageDestinationRef</span> imageDestination = <span class="type">CGImageDestinationCreateWithData</span>((__bridge <span class="type">CFMutableDataRef</span>)imageData, imageUTType, <span class="number">1</span>, <span class="type">NULL</span>);</span><br><span class="line">    <span class="comment">// è®¾ç½®å›¾ç‰‡æ–¹å‘ä¿¡æ¯</span></span><br><span class="line">    <span class="type">NSMutableDictionary</span> *properties = [<span class="type">NSMutableDictionary</span> dictionary];</span><br><span class="line">    <span class="type">NSInteger</span> exifOrientation = [<span class="type">SDWebImageCoderHelper</span> exifOrientationFromImageOrientation:image.imageOrientation];</span><br><span class="line">    [properties setValue:@(exifOrientation) forKey:(__bridge <span class="type">NSString</span> *)kCGImagePropertyOrientation];</span><br><span class="line">    <span class="comment">// æ·»åŠ å›¾ç‰‡ to the destination.</span></span><br><span class="line">    <span class="type">CGImageDestinationAddImage</span>(imageDestination, image.<span class="type">CGImage</span>, (__bridge <span class="type">CFDictionaryRef</span>)properties);</span><br><span class="line">    <span class="comment">// å®Œæˆï¼Œå°†å›¾ç‰‡å†™å…¥æ•°æ®.</span></span><br><span class="line">    <span class="type">CGImageDestinationFinalize</span>(imageDestination);    </span><br><span class="line">    <span class="keyword">return</span> [imageData copy];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°†å›¾ç‰‡è§£ç ï¼Œåªæ˜¯ç®€å•è°ƒç”¨äº†ç³»ç»Ÿæ¥å£ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">UIImage</span> *)decodedImageWithData:(<span class="type">NSData</span> *)data&#123;</span><br><span class="line">       <span class="keyword">if</span> (!data) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">UIImage</span> *image = [[<span class="type">UIImage</span> alloc] initWithData:data];</span><br><span class="line">    image.sd_imageFormat = [<span class="type">NSData</span> sd_imageFormatForImageData:data];</span><br><span class="line">    <span class="keyword">return</span> image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¸è¿›å¼è§£æå›¾ç‰‡ï¼Œä¸»è¦ç”¨åˆ°äº†<code>CGImageSourceCreateIncremental</code>å‡½æ•°å¤„ç†ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">UIImage</span> *)incrementallyDecodedImageWithData:(<span class="type">NSData</span> *)data finished:(<span class="type">BOOL</span>)finished &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_imageSource) &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¸è¿›å¼ImageSource</span></span><br><span class="line">        _imageSource = <span class="type">CGImageSourceCreateIncremental</span>(<span class="type">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">UIImage</span> *image;</span><br><span class="line">    <span class="comment">// å°†ç´¯ç§¯çš„æ•°æ®ä¼ è¿›æ¥ï¼Œä¸ä¸€å®šæ˜¯å®Œæ•´çš„</span></span><br><span class="line">    <span class="type">CGImageSourceUpdateData</span>(_imageSource, (__bridge <span class="type">CFDataRef</span>)data, finished);</span><br><span class="line">    <span class="keyword">if</span> (_width + _height == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// è·å–sourceä¿¡æ¯ï¼Œä»ä¿¡æ¯ä¸­æ‹¿åˆ°å›¾ç‰‡çš„å®½ã€é«˜ã€æ–¹å‘ä¿¡æ¯ï¼Œçœç•¥äº†ä»£ç  </span></span><br><span class="line">        <span class="type">CFDictionaryRef</span> properties = <span class="type">CGImageSourceCopyPropertiesAtIndex</span>(_imageSource, <span class="number">0</span>, <span class="type">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (_width + _height &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°äº†æœ‰æ•ˆä¿¡æ¯ï¼Œå¼€å§‹åˆ›å»ºå›¾ç‰‡</span></span><br><span class="line">        <span class="type">CGImageRef</span> partialImageRef = <span class="type">CGImageSourceCreateImageAtIndex</span>(_imageSource, <span class="number">0</span>, <span class="type">NULL</span>);</span><br><span class="line">        <span class="keyword">if</span> (partialImageRef) &#123;</span><br><span class="line">            image = [[<span class="type">UIImage</span> alloc] initWithCGImage:partialImageRef scale:<span class="number">1</span> orientation:_orientation];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœä¼ å…¥äº†ç»“æŸæ ‡å¿—ï¼Œè¯´æ˜å½“å‰å›¾ç‰‡çš„æ•°æ®ä¸‹è½½å®Œäº†ï¼Œè¿”å›ç”Ÿæˆå¥½çš„image</span></span><br><span class="line">    <span class="keyword">if</span> (finished) &#123;</span><br><span class="line">        <span class="keyword">if</span> (_imageSource) &#123;</span><br><span class="line">            <span class="type">CFRelease</span>(_imageSource);</span><br><span class="line">            _imageSource = <span class="type">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§£å‹ç¼©å›¾ç‰‡ï¼Œä¸»è¦ç”¨<code>CGBitmapContextCreate</code>åˆ›å»ºä½å›¾ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯¥å‡½æ•°æ¥æ”¶å‚æ•°æœ‰dataã€widthã€heightã€bitsPerComponentã€bytesPerRowã€spaceã€bitmapInfo</span></span><br><span class="line"><span class="comment">// data å¦‚æœä¸ä¸ºNULLï¼Œé‚£ä¹ˆå®ƒåº”è¯¥æŒ‡å‘ä¸€å—å¤§å°è‡³å°‘ä¸º bytesPerRow * height å­—èŠ‚çš„å†…å­˜ï¼›å¦‚æœä¸ºNULLï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾æ‰€éœ€çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸€èˆ¬æŒ‡å®šNULLå³å¯ï¼›</span></span><br><span class="line"><span class="comment">// width height ä½å›¾è¦è¾“å‡ºçš„å®½åº¦å’Œé«˜åº¦ï¼Œå®½é«˜æ–¹é¢æœ‰å¤šå°‘é¢—pixelï¼›</span></span><br><span class="line"><span class="comment">// bitsPerComponent ä¸€ä¸ªåƒç´ ä¸­æ¯ä¸ªç‹¬ç«‹çš„é¢œè‰²åˆ†é‡ä½¿ç”¨çš„bitæ•°ï¼Œä¸€ä¸ªåƒç´ ç”±RGBä¸‰è‰²ç»„åˆï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨Rã€Gã€Bæ¯ä¸ªåˆ†é‡ä½¿ç”¨å‡ ä¸ªbitï¼›</span></span><br><span class="line"><span class="comment">// bytesPerRow æ¯ä¸€è¡Œä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œè®¾ä¸º0ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¼˜åŒ–ï¼Œè‡ªè¡Œè®¾å®šå¤§å°è‡³å°‘ä¸º width * bytes per pixelå­—èŠ‚ï¼ŒbytesPerPixelæ˜¯æ¯é¢—åƒç´ éœ€è¦å¤šé•¿å­—èŠ‚å»å­˜å‚¨ï¼›</span></span><br><span class="line"><span class="comment">// space é¢œè‰²ç©ºé—´ï¼Œå¸¸ç”¨çš„æœ‰&lt;RGBã€CMYKã€BGRã€HSB&gt;ï¼Œä¸åŒçš„ç©ºé—´å¯¹ç›¸åŒçš„æ•°å€¼æœ‰ä¸åŒçš„è§£ææ–¹å¼ï¼Œæœ€ç»ˆå¾—åˆ°çš„å›¾ç‰‡è‰²å½©ä¹Ÿä¸ä¸€æ ·ï¼›</span></span><br><span class="line"><span class="comment">// bitmapInfo alphaä¿¡æ¯è¡¨ç¤ºalphaåœ¨åƒç´ ä¸­æ’åœ¨å“ªä¸ªä½ç½®ã€é¢œè‰²åˆ†é‡æ˜¯å¦æµ®ç‚¹ã€åƒç´ æ ¼å¼çš„å­—èŠ‚é¡ºåºï¼›iOSä½¿ç”¨å°ç«¯å­—èŠ‚åºï¼›</span></span><br><span class="line"><span class="type">CG_EXTERN</span> <span class="type">CGContextRef</span> __nullable <span class="type">CGBitmapContextCreate</span>(void * __nullable data,</span><br><span class="line">    size_t width, size_t height, size_t bitsPerComponent, size_t bytesPerRow,</span><br><span class="line">    <span class="type">CGColorSpaceRef</span> cg_nullable space, uint32_t bitmapInfo)</span><br><span class="line">    <span class="type">CG_AVAILABLE_STARTING</span>(__MAC_10_0, __IPHONE_2_0);</span><br><span class="line"></span><br><span class="line">- (nullable <span class="type">UIImage</span> *)sd_decompressedImageWithImage:(nullable <span class="type">UIImage</span> *)image &#123;</span><br><span class="line">    @autoreleasepool&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">CGImageRef</span> imageRef = image.<span class="type">CGImage</span>;</span><br><span class="line">        <span class="comment">// å½“å‰è®¾å¤‡çš„è‰²å½©ç©ºé—´ï¼Œå®ç°ç”¨äº†once_token</span></span><br><span class="line">        <span class="type">CGColorSpaceRef</span> colorspaceRef = <span class="type">SDCGColorSpaceGetDeviceRGB</span>();</span><br><span class="line">        <span class="type">BOOL</span> hasAlpha = <span class="type">SDCGImageRefContainsAlpha</span>(imageRef);</span><br><span class="line">        <span class="comment">// ä½å›¾ä¿¡æ¯ï¼š32ä½ + alphaä¿¡æ¯</span></span><br><span class="line">        <span class="type">CGBitmapInfo</span> bitmapInfo = kCGBitmapByteOrder32Host;</span><br><span class="line">        bitmapInfo |= hasAlpha ? kCGImageAlphaPremultipliedFirst : kCGImageAlphaNoneSkipFirst;</span><br><span class="line">        size_t width = <span class="type">CGImageGetWidth</span>(imageRef);</span><br><span class="line">        size_t height = <span class="type">CGImageGetHeight</span>(imageRef);</span><br><span class="line">        <span class="comment">// ä¼ å…¥å„ç§å‚æ•°</span></span><br><span class="line">        <span class="type">CGContextRef</span> context = <span class="type">CGBitmapContextCreate</span>(<span class="type">NULL</span>,</span><br><span class="line">                                                     width,</span><br><span class="line">                                                     height,</span><br><span class="line">                                                     kBitsPerComponent,</span><br><span class="line">                                                     <span class="number">0</span>,</span><br><span class="line">                                                     colorspaceRef,</span><br><span class="line">                                                     bitmapInfo);</span><br><span class="line">        <span class="keyword">if</span> (context == <span class="type">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> image;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åœ¨ä¸Šä¸‹æ–‡ç»˜åˆ¶å›¾ç‰‡</span></span><br><span class="line">        <span class="type">CGContextDrawImage</span>(context, <span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, width, height), imageRef);</span><br><span class="line">        <span class="comment">// åˆ›å»ºå›¾ç‰‡</span></span><br><span class="line">        <span class="type">CGImageRef</span> imageRefWithoutAlpha = <span class="type">CGBitmapContextCreateImage</span>(context);</span><br><span class="line">        <span class="type">UIImage</span> *imageWithoutAlpha = [[<span class="type">UIImage</span> alloc] initWithCGImage:imageRefWithoutAlpha scale:image.scale orientation:image.imageOrientation];</span><br><span class="line">        <span class="type">CGContextRelease</span>(context);</span><br><span class="line">        <span class="type">CGImageRelease</span>(imageRefWithoutAlpha);</span><br><span class="line">        <span class="keyword">return</span> imageWithoutAlpha;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UIå±•ç¤º"><a href="#UIå±•ç¤º" class="headerlink" title="UIå±•ç¤º"></a>UIå±•ç¤º</h3><p>ä¸ºUIImageViewå’ŒUIButtonæä¾›äº†ç±»åˆ«æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿çš„è®¾ç½®ç›¸åº”çš„å›¾ç‰‡å±æ€§ã€‚</p>
<h4 id="å¸¸ç”¨æ–¹æ³•ï¼š-4"><a href="#å¸¸ç”¨æ–¹æ³•ï¼š-4" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ï¼š"></a>å¸¸ç”¨æ–¹æ³•ï¼š</h4><p>ä¸ºUIImageViewè®¾ç½®å›¾ç‰‡</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (void)sd_setImageWithURL:(nullable <span class="type">NSURL</span> *)url</span><br><span class="line">          placeholderImage:(nullable <span class="type">UIImage</span> *)placeholder;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ å›¾ç‰‡åŠ è½½Activityï¼Œå®šä¹‰åœ¨<code>UIView+WebCache</code>ä¸­ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)sd_setShowActivityIndicatorView:(<span class="type">BOOL</span>)show;</span><br></pre></td></tr></table></figure>

<p>è‡ªå·±åšçš„SDWebImageæ¡†æ¶è„‘å›¾ï¼Œèµ¶è„šæœ‰ç‚¹å¤§ğŸ˜‚</p>
<p>å›¾ç‰‡ç®¡ç†æ¨¡å—</p>
<p><img src="/images/sdwebmanger.png" alt=""></p>
<p>å›¾ç‰‡ä¸‹è½½å·¥å…·æ¨¡å—</p>
<p><img src="/images/sddownloader.png" alt=""></p>
<p>å›¾ç‰‡ç¼“å­˜æ¨¡å—</p>
<p><img src="/images/sdcache.png" alt=""></p>
<p>å›¾ç‰‡è§£ç æ¨¡å—</p>
<p><img src="/images/sdcoder.png" alt=""></p>
<p>æ‰©å±•å·¥å…·æ¨¡å—</p>
<p><img src="/images/sdextension.png" alt=""></p>
<p>å…¶ä»–æ¨¡å—</p>
<p><img src="/images/sdother.png" alt=""></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/22/mac-soft-list/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/22/mac-soft-list/" class="post-title-link" itemprop="url">MACä¸Šè‡ªå·±å¸¸ç”¨çš„è½¯ä»¶æ¸…å•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-22 00:00:00" itemprop="dateCreated datePublished" datetime="2019-01-22T00:00:00+00:00">2019-01-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:05" itemprop="dateModified" datetime="2020-04-26T05:59:05+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mac/" itemprop="url" rel="index"><span itemprop="name">Mac</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åˆ—ä¸€ä¸ªè‡ªå·±åœ¨æ—¥å¸¸å·¥ä½œä¸­ç»å¸¸ç”¨åˆ°çš„çš„MACè½¯ä»¶æ¸…å•ï¼Œä»¥åé‡è£…ç”µè„‘çš„æ—¶å€™å°±å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ¸…å•æ¥ä¸‹è½½äº†ã€‚</p>
<h4 id="å¸¸ç”¨Macåº”ç”¨ç½‘ç«™"><a href="#å¸¸ç”¨Macåº”ç”¨ç½‘ç«™" class="headerlink" title="å¸¸ç”¨Macåº”ç”¨ç½‘ç«™"></a>å¸¸ç”¨Macåº”ç”¨ç½‘ç«™</h4><ul>
<li><a href="http://xclient.info" target="_blank" rel="noopener">XClient</a> </li>
<li><a href="https://macwk.com/" target="_blank" rel="noopener">MacWk</a></li>
</ul>
<h4 id="åº”ç”¨æ— æ³•å®‰è£…ï¼Œæç¤ºæ¥æºä¸æ˜çš„å¼€å‘è€…æˆ–è€…å·²ç ´æŸ"><a href="#åº”ç”¨æ— æ³•å®‰è£…ï¼Œæç¤ºæ¥æºä¸æ˜çš„å¼€å‘è€…æˆ–è€…å·²ç ´æŸ" class="headerlink" title="åº”ç”¨æ— æ³•å®‰è£…ï¼Œæç¤ºæ¥æºä¸æ˜çš„å¼€å‘è€…æˆ–è€…å·²ç ´æŸ"></a>åº”ç”¨æ— æ³•å®‰è£…ï¼Œæç¤ºæ¥æºä¸æ˜çš„å¼€å‘è€…æˆ–è€…å·²ç ´æŸ</h4><p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤åï¼Œé”®å…¥Macçš„ç™»å½•å¯†ç </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo spctl --master-disable</span><br></pre></td></tr></table></figure>

<h4 id="é€šè®¯ç±»"><a href="#é€šè®¯ç±»" class="headerlink" title="é€šè®¯ç±»"></a>é€šè®¯ç±»</h4><ul>
<li><a href="http://im.qq.com/macqq/index.shtml" target="_blank" rel="noopener">QQ</a></li>
<li><a href="https://mac.weixin.qq.com/" target="_blank" rel="noopener">å¾®ä¿¡</a></li>
<li><a href="https://tms.dingtalk.com/markets/dingtalk/download?spm=a3140.8196062.2231602.8.53e35c3duetwd8" target="_blank" rel="noopener">é’‰é’‰</a></li>
</ul>
<h4 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h4><ul>
<li>æ€ç»´å¯¼å›¾ï¼šMindNode , XMind</li>
<li>æµç¨‹å›¾ï¼šOminiGraffle</li>
<li>è§†é¢‘æ’­æ”¾ï¼šMovist, <a href="https://iina.io/" target="_blank" rel="noopener">IINA</a></li>
<li>FTPï¼šYummyFTP, Transmit</li>
<li>è™šæ‹Ÿæœºï¼šParallelsDesktop</li>
<li>è§£å‹ç¼©å·¥å…·ï¼šArchiver, BetterZip</li>
<li>æµè§ˆå™¨ï¼š<a href="https://www.google.cn/chrome/index.html" target="_blank" rel="noopener">Chrome</a></li>
<li>ç¬”è®°ï¼š<a href="https://www.yinxiang.com/download/?offer=www_menu" target="_blank" rel="noopener">å°è±¡ç¬”è®°</a></li>
<li>ç¿»å¢™å¿…å¤‡ï¼š<a href="https://github.com/shadowsocks/ShadowsocksX-NG/releases/" target="_blank" rel="noopener">Shadowsocks</a></li>
<li>NTFSï¼š<a href="https://my.paragon-software.com" target="_blank" rel="noopener">Paragon-NTFS</a></li>
<li>ç”µè„‘æ¸…ç†ï¼š<a href="http://www.mycleanmymac.com/" target="_blank" rel="noopener">CleanMyMac</a></li>
<li>è¿æ¥Androidï¼š<a href="https://www.smartisan.com/apps/#/handshaker" target="_blank" rel="noopener">HandShaker</a></li>
<li>iPhoneæ•°æ®å¤‡ä»½ï¼šiPhone backup extractor</li>
<li>ä¸‹è½½ï¼š<a href="https://mac.eltima.com/cn/download-manager.html" target="_blank" rel="noopener">Folx</a></li>
<li>æ‰¹é‡è®¾å¤‡Appå®‰è£…ï¼š<a href="https://apps.apple.com/cn/app/apple-configurator-2/id1037126344?mt=12" target="_blank" rel="noopener">Apple Configurator</a></li>
</ul>
<h4 id="åŠå…¬ç±»"><a href="#åŠå…¬ç±»" class="headerlink" title="åŠå…¬ç±»"></a>åŠå…¬ç±»</h4><ul>
<li>Office</li>
<li>WPS: <a href="https://pc.wps.cn/" target="_blank" rel="noopener">å®˜ç½‘</a></li>
<li>é‚®ä»¶æ”¶å‘ï¼š<a href="http://www.foxmail.com/mac/" target="_blank" rel="noopener">Foxmail</a></li>
</ul>
<h4 id="å›¾åƒå¤„ç†"><a href="#å›¾åƒå¤„ç†" class="headerlink" title="å›¾åƒå¤„ç†"></a>å›¾åƒå¤„ç†</h4><ul>
<li>å›¾åƒå¤„ç†ï¼šPhotoshop, Affinity Photo, Pixelmator</li>
<li>åˆ‡å›¾ï¼šSketch</li>
<li>é¢œè‰²æå–ï¼š<a href="https://sipapp.io/" target="_blank" rel="noopener">Sip</a></li>
</ul>
<h4 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h4><ul>
<li>æ•°æ®åº“ï¼šSQLPro for SQLite</li>
<li>æŠ“åŒ…å·¥å…·ï¼šCharles</li>
<li>æ¥å£è°ƒè¯•ï¼š<a href="https://www.getpostman.com/" target="_blank" rel="noopener">Postman</a></li>
<li>iOSå¼€å‘ï¼š<a href="https://itunes.apple.com/us/app/xcode/id497799835?mt=12" target="_blank" rel="noopener">Xcode</a></li>
<li>Webå¼€å‘ï¼š<a href="https://www.jetbrains.com/webstorm/" target="_blank" rel="noopener">WebStorm</a></li>
<li>Javaå¼€å‘ï¼š<a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IDEA</a></li>
<li>å°ç¨‹åºå¼€å‘ï¼š<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener">å¾®ä¿¡Webå¼€å‘è€…å·¥å…·</a></li>
</ul>
<h4 id="ç‰ˆæœ¬æ§åˆ¶"><a href="#ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="ç‰ˆæœ¬æ§åˆ¶"></a>ç‰ˆæœ¬æ§åˆ¶</h4><ul>
<li>Gitï¼š<a href="https://cn.atlassian.com/software/sourcetree" target="_blank" rel="noopener">SourceTree</a> <a href="https://www.git-tower.com/" target="_blank" rel="noopener">Tower</a></li>
<li>SVNï¼šCornerstone</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/10/Web-Image-Orientation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/09/10/Web-Image-Orientation/" class="post-title-link" itemprop="url">webä¸Šä¼ å›¾ç‰‡æ–¹å‘çº æ­£</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-09-10 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-10T00:00:00+00:00">2018-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:04" itemprop="dateModified" datetime="2020-04-26T05:59:04+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS%E5%BC%80%E5%8F%91-web/" itemprop="url" rel="index"><span itemprop="name">iOSå¼€å‘ web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ€è¿‘åšçš„åº”ç”¨ä¸­æœ‰ä¸€ä¸ªWKWebViewåŠ è½½äº†ä¸€ä¸ªå¯ä»¥ä¸Šä¼ å›¾ç‰‡çš„ç½‘é¡µï¼Œwebç«¯ç”¨<code>&lt;input type=&#39;file&#39;&gt;</code>æ ‡ç­¾ä¸Šä¼ æ–‡ä»¶ã€‚<br>éšåå‘ç°åœ¨PCç«¯ç”¨<code>&lt;img&gt;</code>å±•ç¤ºçš„æ—¶å€™ï¼Œå›¾ç‰‡å‘ç”Ÿäº†åè½¬ã€‚</p>
<p>å…·ä½“å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­çš„ï¼Œå®¢æˆ·åæ§½ï¼šå¤šå¹´çš„é¢ˆæ¤ç—…éƒ½è¢«æ²»å¥½äº†ã€‚<br><img src="/assets/images/webImageOrientation6.png" alt=""></p>
<p>å› ä¸ºåªæœ‰é€šè¿‡iOSå®¢æˆ·ç«¯ä¸Šä¼ çš„å›¾ç‰‡æ‰ä¼šåè½¬ï¼Œæ‰€ä»¥é—®äº†è´Ÿè´£Androidå®¢æˆ·ç«¯çš„åŒå­¦ï¼ŒåŸæ¥Androidçš„webViewåœ¨æ–‡ä»¶ä¸Šä¼ å‰æœ‰å›è°ƒï¼Œåœ¨å›è°ƒé‡Œé¢å¯¹å›¾ç‰‡æ–¹å‘è¿›è¡Œäº†å¤„ç†ã€‚</p>
<p>äºæ˜¯æˆ‘ç¿»çœ‹äº†WKWebViewå¤´æ–‡ä»¶ä¸­ç›¸åº”ä»£ç†çš„å›è°ƒï¼Œå¹¶æ²¡æœ‰è¿™ç§æ–‡ä»¶ä¸Šä¼ çš„å›è°ƒï¼Œåœ¨ç½‘ä¸Šçœ‹äº†ä¸€ä¸‹å…¶ä»–äººçš„è§£å†³æ–¹æ¡ˆï¼Œå¤§è‡´éƒ½æ˜¯é€šè¿‡runtimeæ›¿æ¢äº†ViewControllerçš„<code>presentViewController: animated: completion:</code>å’Œ<code>dismissViewControllerAnimated: completion:</code>æ–¹æ³•ã€‚</p>
<p>ç„¶ååœ¨æ–¹æ³•ä¸­åˆ¤æ–­presentçš„viewcontrolleræ˜¯å¦æ˜¯<code>UIDocumentMenuViewController</code>ç±»å‹ï¼Œä¸”ä»£ç†æ˜¯<code>WKFileUploadPanel</code>æˆ–<code>UIWebFileUploadPanel</code>ï¼Œå¯¹å…¶è¿›è¡Œæ‹¦æˆªï¼Œç”±è‡ªå·±æ¥ç®¡åç»­å›¾ç‰‡çš„å¤„ç†å’Œä¸Šä¼ ï¼Œä¸è¿‡ä¸Šä¼ åï¼Œè¿˜æ˜¯éœ€è¦å°†å›¾ç‰‡URLä¼ é€’ç»™webç½‘é¡µå±•ç¤ºï¼Œè¿™æ ·çš„è¯ï¼ŒAndroidå®¢æˆ·ç«¯ä¹Ÿéœ€è¦è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œæ”¹åŠ¨å°±å¤§äº†ï¼Œæ‰€ä»¥æ”¾å¼ƒåœ¨iOSç«¯æ”¹åŠ¨ã€‚å…·ä½“å‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/frog78/Gigi" target="_blank" rel="noopener">iOSæ‹¦æˆª&lt;input&gt;æ ‡ç­¾</a></p>
<p>äºæ˜¯å°±åªèƒ½åœ¨webç«¯æ”¹ä»£ç äº†ï¼Œwebç«¯æ—‹è½¬å‹ç¼©å›¾ç‰‡çš„è¯ï¼Œä¸»è¦ç”¨çš„è¿˜æ˜¯canvasã€‚ä½†æ˜¯è·å–å›¾ç‰‡çš„æ–¹å‘çš„è¯ï¼Œéœ€è¦ç”¨åˆ°<a href="https://github.com/exif-js/exif-js" target="_blank" rel="noopener">exif.js</a>ï¼›</p>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œä¸Šä»£ç ï¼Œé¦–å…ˆå¼•å…¥exif.jsï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/exif.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›‘å¬inputæ ‡ç­¾ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">accept</span>=<span class="string">"image/*"</span> <span class="attr">class</span>=<span class="string">"uploadInput"</span> <span class="attr">style</span>=<span class="string">"display: none"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">$(<span class="string">".uploadInput"</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> file = e.target.files[<span class="number">0</span>];</span></span><br><span class="line"><span class="actionscript">    FixImg(file, <span class="function"><span class="keyword">function</span> <span class="params">(imgFile)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// ä¸Šä¼ å›¾ç‰‡</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> formdata = <span class="keyword">new</span> FormData();</span></span><br><span class="line"><span class="actionscript">        formdata.append(<span class="string">'file'</span>, imgFile);</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">            url: <span class="string">'upload.do'</span>,</span></span><br><span class="line"><span class="actionscript">            type: <span class="string">'POST'</span>,</span></span><br><span class="line">            data: formdata,</span><br><span class="line"><span class="actionscript">            processData: <span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">            contentType: <span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">            success: <span class="function"><span class="keyword">function</span> <span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="comment">// å›¾ç‰‡ä¸Šä¼ æˆåŠŸ</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…·ä½“å‹ç¼©æ—‹è½¬å‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FixImg</span>(<span class="params">file, callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//å›¾ç‰‡å‹ç¼©è´¨é‡</span></span><br><span class="line">    <span class="keyword">var</span> quality = <span class="number">0.65</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ‰€éœ€å˜é‡</span></span><br><span class="line">    <span class="keyword">let</span> Orientation, ctxWidth, ctxHeight, base64; </span><br><span class="line">    <span class="comment">// EXIF è·å–å›¾ç‰‡æ–¹å‘ä¿¡æ¯</span></span><br><span class="line">    EXIF.getData(file, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        Orientation = EXIF.getTag(<span class="keyword">this</span>, <span class="string">'Orientation'</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> fileReader = <span class="keyword">new</span> FileReader();</span><br><span class="line">        fileReader.readAsDataURL(file);</span><br><span class="line">        fileReader.onload = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> res = event.target.result;</span><br><span class="line">            <span class="keyword">var</span> image = <span class="keyword">new</span> Image();</span><br><span class="line">            image.src = res;</span><br><span class="line">            image.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                ctxWidth = <span class="keyword">this</span>.naturalWidth;</span><br><span class="line">                ctxHeight = <span class="keyword">this</span>.naturalHeight;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</span><br><span class="line">                <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">'2d'</span>);</span><br><span class="line"></span><br><span class="line">                canvas.width = ctxWidth;</span><br><span class="line">                canvas.height = ctxHeight;</span><br><span class="line">                <span class="keyword">if</span> ([<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>].includes(Orientation)) &#123;</span><br><span class="line">                    canvas.width = ctxHeight;</span><br><span class="line">                    canvas.height = ctxWidth;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">switch</span> (Orientation) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                        ctx.transform(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, ctxWidth, <span class="number">0</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                        ctx.transform(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, ctxWidth, ctxHeight;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                        ctx.transform(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, ctxHeight);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                        ctx.transform(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                        ctx.transform(<span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, ctxHeight, <span class="number">0</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                        ctx.transform(<span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, ctxHeight, ctxWidth;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                        ctx.transform(<span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, ctxWidth);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        ctx.transform(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                ctx.drawImage(image, <span class="number">0</span>, <span class="number">0</span>, ctxWidth, ctxHeight);</span><br><span class="line"></span><br><span class="line">                canvas.toBlob(<span class="function"><span class="keyword">function</span> (<span class="params">blob</span>) </span>&#123;</span><br><span class="line">                    <span class="comment">// ä¸Šä¼ æ¥å£åªæ¥å—fileï¼Œæ‰€ä»¥blobè½¬ä¸ºfileå†ä¸Šä¼ </span></span><br><span class="line">                    <span class="keyword">let</span> files = <span class="keyword">new</span> <span class="built_in">window</span>.File([blob], file.name, &#123;<span class="attr">type</span>: file.type&#125;)</span><br><span class="line">                    callback(files);</span><br><span class="line">                &#125;, <span class="string">'multipart/form-data'</span>, quality)</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/15/iOS-Health/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/15/iOS-Health/" class="post-title-link" itemprop="url">iOS HealthKit æ¥å…¥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-08-15 00:00:00" itemprop="dateCreated datePublished" datetime="2018-08-15T00:00:00+00:00">2018-08-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:05" itemprop="dateModified" datetime="2020-04-26T05:59:05+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">iOSå¼€å‘</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>HealthKitæ˜¯è‹¹æœæä¾›çš„ä¸€ä¸ªå¥åº·æ•°æ®æ¥å…¥åº“ï¼Œå¼€å‘äººå‘˜å¯ä»¥ç”±æ­¤è¯»å–ã€å†™å…¥å¥åº·æ•°æ®ï¼Œä¸è¿‡ä¾æ—§æ˜¯éœ€è¦å…ˆè·å–ç›¸åº”çš„æ¥å…¥æƒé™æ‰èƒ½ä½¿ç”¨ã€‚</p>
<p>ä»¥è¯»å–å’Œå†™å…¥å¥åº·æ­¥æ•°ä¸ºä¾‹ï¼Œé¦–å…ˆç”¨Xcodeæ–°å»ºä¸€ä¸ªç©ºç™½é¡¹ç›®ï¼Œç„¶åé…ç½®é¡¹ç›®ç›¸åº”çš„é€‰é¡¹ï¼š</p>
<ol>
<li><p>info.plist æ·»åŠ <code>NSHealthUpdateUsageDescription</code>å’Œ<code>NSHealthShareUsageDescription</code>;</p>
</li>
<li><p>Capabilitiesé€‰é¡¹ä¸­æ‰“å¼€<code>HealthKit</code>;</p>
</li>
<li><p>BuildPhasesé€‰é¡¹ä¸­æ·»åŠ <code>HealthKit.frmaework</code>;</p>
</li>
</ol>
<p>å†™ä¸€ä¸ªå·¥å…·ç±»<code>HKHandle</code>ï¼Œç”¨æ¥åˆ¤æ–­è®¾å¤‡æ˜¯å¦æ”¯æŒHealthKitã€è¯·æ±‚ç›¸åº”æƒé™ä¹‹ç±»çš„åŠŸèƒ½ï¼ŒäºŒè¯ä¸è¯´ä¸Šä»£ç ã€‚</p>
<h3 id="HKHandle-h-æ–‡ä»¶ï¼Œå®šä¹‰å‡ ä¸ªå¸¸ç”¨çš„æ¥å£ï¼š"><a href="#HKHandle-h-æ–‡ä»¶ï¼Œå®šä¹‰å‡ ä¸ªå¸¸ç”¨çš„æ¥å£ï¼š" class="headerlink" title="HKHandle.h æ–‡ä»¶ï¼Œå®šä¹‰å‡ ä¸ªå¸¸ç”¨çš„æ¥å£ï¼š"></a>HKHandle.h æ–‡ä»¶ï¼Œå®šä¹‰å‡ ä¸ªå¸¸ç”¨çš„æ¥å£ï¼š</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HKHandle.h</span></span><br><span class="line">#<span class="keyword">import</span> &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#<span class="keyword">import</span> &lt;HealthKit/HealthKit.h&gt;</span><br><span class="line"></span><br><span class="line">@interface <span class="type">HKHandle</span> : <span class="type">NSObject</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// HealthKit å®ä¾‹ï¼Œå…¨å±€æœ€å¥½åªæœ‰ä¸€ä¸ªstore</span></span><br><span class="line">+ (<span class="type">HKHealthStore</span> *)singleStore;</span><br><span class="line"><span class="comment">// é»˜è®¤è¦è®¿é—®çš„HealthKitæƒé™</span></span><br><span class="line">+ (<span class="type">NSSet</span> *)defaultHKSet;</span><br><span class="line"><span class="comment">// è¯·æ±‚è·å–HealthKitæƒé™</span></span><br><span class="line">+ (void)requsetDefaultAuth:(void(^)(<span class="type">BOOL</span> suc, <span class="type">NSString</span> *msg))complention;</span><br><span class="line"><span class="comment">// å†™å…¥æ•°æ®çš„è®¾å¤‡ä¿¡æ¯ï¼Œéå¿…éœ€</span></span><br><span class="line">+ (<span class="type">HKDevice</span> *)defaultDevice;</span><br><span class="line"><span class="comment">// è¯»å–å¥åº·æ•°æ®</span></span><br><span class="line">+ (void)readDataWithSampleType:(<span class="type">HKSampleType</span> *)type completion:(void(^)(<span class="type">NSArray</span> *results, <span class="type">NSError</span> *error))completion;</span><br><span class="line"><span class="comment">// ä¿å­˜å¥åº·æ•°æ®</span></span><br><span class="line">+ (void)saveHKObject:(<span class="type">HKObject</span> *)obj completion:(void (^) (<span class="type">BOOL</span> suc, <span class="type">NSError</span> *error))completion;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<h3 id="HKHandle-mæ–‡ä»¶ï¼Œæ¥å£çš„å…·ä½“å®ç°ï¼š"><a href="#HKHandle-mæ–‡ä»¶ï¼Œæ¥å£çš„å…·ä½“å®ç°ï¼š" class="headerlink" title="HKHandle.mæ–‡ä»¶ï¼Œæ¥å£çš„å…·ä½“å®ç°ï¼š"></a>HKHandle.mæ–‡ä»¶ï¼Œæ¥å£çš„å…·ä½“å®ç°ï¼š</h3><p>ç”Ÿæˆå•ä¾‹storeå¯¹è±¡ï¼Œç”¨äºå­˜å‚¨å¥åº·æ•°æ®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="type">HKHealthStore</span> *)singleStore&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="type">HKHealthStore</span> *store;</span><br><span class="line">    <span class="keyword">static</span> dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        store = [[<span class="type">HKHealthStore</span> alloc] <span class="keyword">init</span>];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> store;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¥åº·æ•°æ®ç±»å‹ï¼Œè¿™é‡Œåªæœ‰æ­¥æ•°ç±»å‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="type">NSSet</span> *)defaultHKSet</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ­¥æ•°</span></span><br><span class="line">    <span class="type">NSSet</span> *<span class="keyword">set</span> = [<span class="type">NSSet</span> setWithObjects:</span><br><span class="line">                  [<span class="type">HKQuantityType</span> quantityTypeForIdentifier:<span class="type">HKQuantityTypeIdentifierStepCount</span>],<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">set</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ¤æ–­è®¾å¤‡æ˜¯å¦æ”¯æŒï¼Œè¯·æ±‚HealthKitæƒé™ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ (void)requsetDefaultAuth:(void(^)(<span class="type">BOOL</span> suc, <span class="type">NSString</span> *msg))complention&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">HKHealthStore</span> *store = [<span class="keyword">self</span> singleStore];</span><br><span class="line">    <span class="keyword">if</span> (![<span class="type">HKHealthStore</span> isHealthDataAvailable])&#123;</span><br><span class="line">        <span class="comment">// è®¾å¤‡ä¸æ”¯æŒ HealthKit</span></span><br><span class="line">        <span class="keyword">if</span> (complention)&#123;</span><br><span class="line">            complention(<span class="type">NO</span>, @<span class="string">"è®¾å¤‡ä¸æ”¯æŒHealthKit"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯·æ±‚ç›¸åº”å¥åº·æƒé™</span></span><br><span class="line">    <span class="type">NSSet</span> *hkset = [<span class="keyword">self</span> defaultHKSet];</span><br><span class="line">    [store requestAuthorizationToShareTypes:hkset readTypes:hkset completion:^(<span class="type">BOOL</span> success, <span class="type">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">NSLog</span>(@<span class="string">"auth success = %@, error = %@"</span>,@(success), error);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (complention)&#123;</span><br><span class="line">            complention(success, error.localizedDescription);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>âš ï¸å¥åº·æ•°æ®çš„è¯»å–å’Œå†™å…¥ï¼Œéƒ½éœ€è¦å…ˆè·å¾—ç›¸åº”çš„æƒé™</em></p>
<p>è¯»å–æ­¥æ•°ï¼š<br>HealthKitè¯»å–æ•°æ®ï¼Œéœ€è¦ä¸€ä¸ªqueryå¯¹è±¡ï¼Œæ­¥æ•°è¯»å–éœ€è¦<code>HKSampleQuery</code>ç±»å‹çš„queryã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">+ (void)readDataWithSampleType:(<span class="type">HKSampleType</span> *)type completion:(void(^)(<span class="type">NSArray</span> *results, <span class="type">NSError</span> *error))completion&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">NSPredicate</span> *predicate = [<span class="keyword">self</span> todayPredicate];</span><br><span class="line">    </span><br><span class="line">    <span class="type">HKSampleQuery</span> *query = [[<span class="type">HKSampleQuery</span> alloc] initWithSampleType:type predicate:predicate limit:<span class="type">HKObjectQueryNoLimit</span> sortDescriptors:<span class="literal">nil</span> resultsHandler:^(<span class="type">HKSampleQuery</span> * _Nonnull query, <span class="type">NSArray</span>&lt;__kindof <span class="type">HKSample</span> *&gt; * _Nullable results, <span class="type">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (completion)&#123;</span><br><span class="line">            </span><br><span class="line">            completion(results, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="type">HKHealthStore</span> *store = [<span class="keyword">self</span> singleStore];</span><br><span class="line">    [store executeQuery:query];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="type">NSPredicate</span> *)todayPredicate&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">NSCalendar</span> *calendar = [<span class="type">NSCalendar</span> currentCalendar];</span><br><span class="line">    <span class="type">NSDate</span> *now = [<span class="type">NSDate</span> date];</span><br><span class="line">    <span class="type">NSDateComponents</span> *components = [calendar components:<span class="type">NSCalendarUnitYear</span>|<span class="type">NSCalendarUnitMonth</span>|<span class="type">NSCalendarUnitDay</span> fromDate:now];</span><br><span class="line">    <span class="type">NSDate</span> *startDate = [calendar dateFromComponents:components];</span><br><span class="line">    <span class="type">NSDate</span> *endDate = [calendar dateByAddingUnit:<span class="type">NSCalendarUnitDay</span> value:<span class="number">1</span> toDate:startDate options:<span class="number">0</span>];</span><br><span class="line">    <span class="type">NSPredicate</span> *predicate = [<span class="type">HKQuery</span> predicateForSamplesWithStartDate:startDate endDate:endDate options:<span class="type">HKQueryOptionStrictStartDate</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> predicate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è·å–åˆ°æ­¥æ•°çš„å¤„ç†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">IBAction</span>)readSteps:(id)sender &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">HKSampleType</span> *stepType = [<span class="type">HKSampleType</span> quantityTypeForIdentifier:<span class="type">HKQuantityTypeIdentifierStepCount</span>];</span><br><span class="line">    [<span class="type">HKHandle</span> readDataWithSampleType:stepType completion:^(<span class="type">NSArray</span> *results, <span class="type">NSError</span> *error) &#123;</span><br><span class="line">        <span class="comment">// åˆ‡æ¢ä¸»çº¿ç¨‹</span></span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">if</span> (!results)&#123;</span><br><span class="line">                <span class="type">NSLog</span>(@<span class="string">"æŸ¥è¯¢å¤±è´¥äº† error = %@"</span>,error);</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">NSInteger</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">HKQuantitySample</span> *sample <span class="keyword">in</span> results) &#123;</span><br><span class="line">                double <span class="built_in">count</span> = [sample.quantity doubleValueForUnit:[<span class="type">HKUnit</span> countUnit]];</span><br><span class="line">                sum += <span class="built_in">count</span>;</span><br><span class="line">                <span class="type">NSLog</span>(@<span class="string">"count = %@"</span>,@(<span class="built_in">count</span>));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">self</span>.title = [<span class="type">NSString</span> stringWithFormat:@<span class="string">"%@"</span>,@(sum)];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šç”¨ä¿å­˜å¥åº·æ•°æ®æ¥å£ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šç”¨ä¿å­˜æ¥å£</span></span><br><span class="line">+ (void)saveHKObject:(<span class="type">HKObject</span> *)obj completion:(void (^) (<span class="type">BOOL</span> suc, <span class="type">NSError</span> *error))completion&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (![obj isKindOfClass:[<span class="type">HKObject</span> <span class="class"><span class="keyword">class</span>]])</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">HKHealthStore</span> *store = [<span class="keyword">self</span> singleStore];</span><br><span class="line">    <span class="comment">// ä¿å­˜å¥åº·æ•°æ®</span></span><br><span class="line">    [store saveObject:obj withCompletion:^(<span class="type">BOOL</span> success, <span class="type">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (completion)&#123;</span><br><span class="line">            </span><br><span class="line">            completion(success, error);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆæ­¥æ•°ï¼Œè°ƒç”¨å†™å…¥æ¥å£:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿæˆæ­¥æ•°ï¼Œè°ƒç”¨æ¥å£å†™å…¥</span></span><br><span class="line">- (<span class="type">IBAction</span>)writeSetp:(id)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.view endEditing:<span class="type">YES</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_stepCount == <span class="number">0</span> || _startTime == <span class="literal">nil</span> || _endTime == <span class="literal">nil</span>)&#123;</span><br><span class="line">        [<span class="type">UIAlertController</span> showSimpleAlertWithTitle:@<span class="string">"æç¤º"</span> message:@<span class="string">"è¯·è¡¥å……æ‰€æœ‰é€‰é¡¹"</span> presentdViewController:<span class="keyword">self</span>];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ­¥æ•°</span></span><br><span class="line">    <span class="type">HKQuantity</span> *steps = [<span class="type">HKQuantity</span> quantityWithUnit:[<span class="type">HKUnit</span> countUnit] doubleValue:_stepCount];</span><br><span class="line">    </span><br><span class="line">    <span class="type">HKQuantitySample</span> *stepSample = [<span class="type">HKQuantitySample</span> quantitySampleWithType:[<span class="type">HKQuantityType</span> quantityTypeForIdentifier:<span class="type">HKQuantityTypeIdentifierStepCount</span>] quantity:steps startDate:_startTime endDate:_endTime device:[<span class="type">HKHandle</span> defaultDevice] metadata:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    [<span class="type">HKHandle</span> saveHKObject:stepSample completion:^(<span class="type">BOOL</span> suc, <span class="type">NSError</span> *error) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (suc)&#123;</span><br><span class="line">            </span><br><span class="line">            [<span class="type">UIAlertController</span> showSimpleAlertWithTitle:@<span class="string">"æç¤º"</span> message:@<span class="string">"å†™å…¥æˆåŠŸ"</span> presentdViewController:<span class="keyword">self</span>];</span><br><span class="line">            </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            </span><br><span class="line">            <span class="type">NSLog</span>(@<span class="string">"å†™å…¥å¤±è´¥ï¼Œerror = %@"</span>,error);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/15/dev-QA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/15/dev-QA/" class="post-title-link" itemprop="url">iOSå¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-05-15 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-15T00:00:00+00:00">2018-05-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:05" itemprop="dateModified" datetime="2020-04-26T05:59:05+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">iOSå¼€å‘</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>è®°å½•ä¸€ä¸‹è‡ªå·±åœ¨æ—¥å¸¸çš„iOSå¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ä»¥åŠè§£å†³æ–¹æ³•ï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…ã€‚</p>
<h3 id="SVNæ— æ³•ä¸Šä¼ -aæ–‡ä»¶"><a href="#SVNæ— æ³•ä¸Šä¼ -aæ–‡ä»¶" class="headerlink" title="SVNæ— æ³•ä¸Šä¼ .aæ–‡ä»¶"></a>SVNæ— æ³•ä¸Šä¼ .aæ–‡ä»¶</h3><p>Xcodeè‡ªå¸¦çš„svnå’ŒVersionsä»¥åŠä¸€äº›å…¶å®ƒå·¥å…·éƒ½æœ‰é»˜è®¤å¿½ç•¥<code>.a</code>æ–‡ä»¶ã€‚</p>
<p>åœ¨Versionsä¸­æ‰‹åŠ¨æ·»åŠ æ–‡ä»¶ï¼š<br>é€‰æ‹©Versionsçš„èœå•Viewâ€“&gt;Show Ignored Itemsï¼Œè¿™æ ·å°±ä¼šæ˜¾ç¤ºå‡ºignoredçš„æ–‡ä»¶ï¼Œæ‰¾åˆ°ä½ è¦ä¸Šä¼ çš„<code>.a</code>æ–‡ä»¶ï¼Œå³é”®<code>Add</code>å°±å¯ä»¥äº†ã€‚</p>
<h3 id="Xcode-unable-to-run-app-in-simulator"><a href="#Xcode-unable-to-run-app-in-simulator" class="headerlink" title="Xcode unable to run app in simulator"></a>Xcode unable to run app in simulator</h3><p>Xcode ç•Œé¢ï¼Œ<code>shift + command +2</code> å¿«é€Ÿè¿›å…¥<code>devices</code>çª—å£ï¼ŒæŸ¥çœ‹å½“å‰çš„å¯ç”¨è®¾å¤‡ï¼Œæ‰¾åˆ°æ— æ³•å¯åŠ¨çš„æ¨¡æ‹Ÿå™¨ï¼Œåˆ é™¤å¹¶é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡æ‹Ÿå™¨ï¼Œå†æ¬¡è¿è¡Œè¯¥æ¨¡æ‹Ÿå™¨å³å¯</p>
<h3 id="Cannot-assign-to-self-out-of-a-method-in-the-init-family"><a href="#Cannot-assign-to-self-out-of-a-method-in-the-init-family" class="headerlink" title="Cannot assign to self out of a method in the init family?"></a>Cannot assign to self out of a method in the init family?</h3><p>åˆå§‹åŒ–æ–¹æ³•å¿…é¡»ä»¥initå¼€å¤´ï¼Œå¹¶éµå¾ªé©¼å³°å‘½åæ³•åˆ™</p>
<h3 id="file-has-been-modified-since-the-precompiled-header-was-built"><a href="#file-has-been-modified-since-the-precompiled-header-was-built" class="headerlink" title="file has been modified since the precompiled header was built"></a>file has been modified since the precompiled header was built</h3><p>åœ¨Macç»ˆç«¯åˆ é™¤derivedDataï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/Library/Developer/Xcode/DerivedData</span><br></pre></td></tr></table></figure>
<p>é‡æ–°clean build</p>
<h3 id="ä½¿ç”¨Storyboardé¡µé¢è·³è½¬æ—¶ï¼ŒtableViewçš„ContentOffset-è«ååç§»"><a href="#ä½¿ç”¨Storyboardé¡µé¢è·³è½¬æ—¶ï¼ŒtableViewçš„ContentOffset-è«ååç§»" class="headerlink" title="ä½¿ç”¨Storyboardé¡µé¢è·³è½¬æ—¶ï¼ŒtableViewçš„ContentOffset è«ååç§»"></a>ä½¿ç”¨Storyboardé¡µé¢è·³è½¬æ—¶ï¼ŒtableViewçš„ContentOffset è«ååç§»</h3><p>ä¸è¦å‹¾é€‰xibæ–‡ä»¶çš„<code>Adjust Scroll View Insets</code></p>
<h3 id="UITableView-setEditing-YES-animation-YES-æ²¡æœ‰åŠ¨ç”»æ•ˆæœ"><a href="#UITableView-setEditing-YES-animation-YES-æ²¡æœ‰åŠ¨ç”»æ•ˆæœ" class="headerlink" title="UITableView setEditing:YES animation:YES æ²¡æœ‰åŠ¨ç”»æ•ˆæœ"></a>UITableView setEditing:YES animation:YES æ²¡æœ‰åŠ¨ç”»æ•ˆæœ</h3><p>å› ä¸ºåé¢å†æ¬¡è°ƒç”¨äº†reloadDataå¯¼è‡´çš„ã€‚è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ–¹æ¡ˆä¸€ï¼š</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">CATransaction</span> begin];</span><br><span class="line">[<span class="type">CATransaction</span> setCompletionBlock: ^&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//animation ç»“æŸä¹‹åè¦è¿è¡Œçš„ä»£ç  </span></span><br><span class="line"></span><br><span class="line">&#125;]; </span><br><span class="line">[_tblView setEditing:<span class="type">YES</span> animated:<span class="type">YES</span>]; </span><br><span class="line">[<span class="type">CATransaction</span> commit];</span><br></pre></td></tr></table></figure>

<ul>
<li>æ–¹æ¡ˆäºŒï¼š</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">UIView</span> animateWithDuration:<span class="number">0</span>.3f</span><br><span class="line">                 animations:^&#123;</span><br><span class="line">                    [<span class="keyword">self</span>.tableView setEditing:<span class="type">YES</span> animated:<span class="type">NO</span>];</span><br><span class="line">                 &#125;</span><br><span class="line">                 completion:^(<span class="type">BOOL</span> finished)&#123;</span><br><span class="line">                   <span class="comment">// animation ç»“æŸä¹‹åè¦è¿è¡Œçš„ä»£ç </span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>





<h3 id="The-document-â€œMainStoryboard-storyboardâ€-could-not-be-opened-The-operation-couldnâ€™t-be-completed-com-apple-InterfaceBuilder-error-1-Check-the-console-log-for-additional-information"><a href="#The-document-â€œMainStoryboard-storyboardâ€-could-not-be-opened-The-operation-couldnâ€™t-be-completed-com-apple-InterfaceBuilder-error-1-Check-the-console-log-for-additional-information" class="headerlink" title="The document â€œMainStoryboard.storyboardâ€ could not be opened. The operation couldnâ€™t be completed. (com.apple.InterfaceBuilder error -1.) Check the console log for additional information."></a>The document â€œMainStoryboard.storyboardâ€ could not be opened. The operation couldnâ€™t be completed. (com.apple.InterfaceBuilder error -1.) Check the console log for additional information.</h3><p>1.open storyboard as <code>source code</code> </p>
<p>2.find <code>interredMetricsTieBreakers</code> block</p>
<p>3.remove all <code>&lt;segue reference = â€œâ€ /&gt;</code></p>
<p>4.open storyboard as <code>interFace Builder</code></p>
<h3 id="The-document-â€œ-xxxx-xibâ€-could-not-be-opened"><a href="#The-document-â€œ-xxxx-xibâ€-could-not-be-opened" class="headerlink" title="The document â€œ xxxx.xibâ€ could not be opened."></a>The document â€œ xxxx.xibâ€ could not be opened.</h3><p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>1.åˆ é™¤xibçš„ source code é‡Œçš„å†²çª</p>
<p>2.å³é”®.xibæ–‡ä»¶ -&gt; show file in inspector æ–‡ä»¶typeï¼šdefault interface builder cocoa touch xib  (Xcode 7 ç‚¹å‡»ä¸€æ¬¡ok)</p>
<h3 id="AVCçš„Viewè‡ªåŠ¨åŠ è½½AViewçš„nibæ–‡ä»¶"><a href="#AVCçš„Viewè‡ªåŠ¨åŠ è½½AViewçš„nibæ–‡ä»¶" class="headerlink" title="AVCçš„Viewè‡ªåŠ¨åŠ è½½AViewçš„nibæ–‡ä»¶"></a>AVCçš„Viewè‡ªåŠ¨åŠ è½½AViewçš„nibæ–‡ä»¶</h3><p>å®ä¾‹ï¼šiOS 10.3.3çœŸæœº<br>å·¥ç¨‹ä¸­ä»¥å‰æœ‰ä¸€ä¸ªåä¸ºRewardViewçš„Viewæºæ–‡ä»¶ä»¥åŠç›¸åº”çš„nibæ–‡ä»¶ï¼Œå†æ–°å»ºä¸€ä¸ªRewardViewControllerçš„æºæ–‡ä»¶ä¸å¸¦nibæ–‡ä»¶ï¼Œå½“RewardViewControlleråˆå§‹åŒ–æ—¶ï¼Œç«Ÿç„¶æŠŠRewardViewçš„nibæ–‡ä»¶åŠ è½½è¿›æ¥å•¦å•¦å•¦ï¼Œæˆ‘ä¹Ÿæ˜¯æ— è¨€ä»¥å¯¹ï¼Œéš¾é“VCçš„ViewåŠ è½½æœºåˆ¶æ˜¯ä¼˜å…ˆåŠ è½½å‘½åç±»ä¼¼çš„nibæ–‡ä»¶ï¼Ÿï¼Ÿï¼Ÿ</p>
<h3 id="ç”¨cocoapodså®‰è£…çš„ç¬¬ä¸‰æ–¹åº“é»˜è®¤iOS-Deployment-Target-4-3ï¼Œå¯¼è‡´å·¥ç¨‹ç¼–è¯‘é”™è¯¯"><a href="#ç”¨cocoapodså®‰è£…çš„ç¬¬ä¸‰æ–¹åº“é»˜è®¤iOS-Deployment-Target-4-3ï¼Œå¯¼è‡´å·¥ç¨‹ç¼–è¯‘é”™è¯¯" class="headerlink" title="ç”¨cocoapodså®‰è£…çš„ç¬¬ä¸‰æ–¹åº“é»˜è®¤iOS Deployment Target 4.3ï¼Œå¯¼è‡´å·¥ç¨‹ç¼–è¯‘é”™è¯¯"></a>ç”¨cocoapodså®‰è£…çš„ç¬¬ä¸‰æ–¹åº“é»˜è®¤iOS Deployment Target 4.3ï¼Œå¯¼è‡´å·¥ç¨‹ç¼–è¯‘é”™è¯¯</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">post_install <span class="keyword">do</span> |installer| </span><br><span class="line">    installer.pods_project.targets.each <span class="keyword">do</span> |target| </span><br><span class="line">        target.build_configurations.each <span class="keyword">do</span> |config| </span><br><span class="line">            config.build_settings['<span class="type">IPHONEOS_DEPLOYMENT_TARGET'</span>] = '<span class="number">8.0</span>' </span><br><span class="line">        end </span><br><span class="line">    end </span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>å°†ä¸Šé¢çš„ä»£ç ä¸­çš„<code>8.0</code>æ›¿æ¢æˆä½ è¦çš„ç³»ç»Ÿç‰ˆæœ¬å·åï¼Œç²˜è´´åœ¨<code>podfile</code>æ–‡ä»¶åé¢ï¼Œæ‰§è¡Œ<code>pod update</code> æˆ–è€… <code>pod install</code> å³å¯ã€‚</p>
<h4 id="iOS11tableView-cell-åˆ†å‰²çº¿é—®é¢˜"><a href="#iOS11tableView-cell-åˆ†å‰²çº¿é—®é¢˜" class="headerlink" title="iOS11tableView cell åˆ†å‰²çº¿é—®é¢˜"></a>iOS11tableView cell åˆ†å‰²çº¿é—®é¢˜</h4><p>æ²¡æœ‰é€šè¿‡nibåŠ è½½çš„cellï¼Œéƒ½ä¼šå‡ºç°ç³»ç»Ÿçš„åˆ†å‰²çº¿ï¼Œé€šè¿‡nibåŠ è½½çš„cellä¸ä¼šå‡ºç°åˆ†å‰²çº¿</p>
<h3 id="podsçš„ç¬¬ä¸‰æ–¹åº“æœ‰å¥½å¤šWarning"><a href="#podsçš„ç¬¬ä¸‰æ–¹åº“æœ‰å¥½å¤šWarning" class="headerlink" title="podsçš„ç¬¬ä¸‰æ–¹åº“æœ‰å¥½å¤šWarning"></a>podsçš„ç¬¬ä¸‰æ–¹åº“æœ‰å¥½å¤šWarning</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod '<span class="type">SSZipArchive'</span>, :inhibit_warnings =&gt; <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰tabBarControllerçš„tabBarçš„titleæ˜¾ç¤ºé—®é¢˜"><a href="#è‡ªå®šä¹‰tabBarControllerçš„tabBarçš„titleæ˜¾ç¤ºé—®é¢˜" class="headerlink" title="è‡ªå®šä¹‰tabBarControllerçš„tabBarçš„titleæ˜¾ç¤ºé—®é¢˜"></a>è‡ªå®šä¹‰tabBarControllerçš„tabBarçš„titleæ˜¾ç¤ºé—®é¢˜</h3><p>è‡ªå®šä¹‰tabBarçš„titleè·Ÿç³»ç»Ÿçš„titleé‡å½±ï¼Œä¸è¦ç›´æ¥è®¾ç½®<code>vc.title=@â€œâ€</code>ï¼Œè¦è®¾ç½®<code>vc.navigationItem.title=@â€œâ€</code></p>
<h3 id="Appæƒ³ç”¨httpæ€ä¹ˆåŠ"><a href="#Appæƒ³ç”¨httpæ€ä¹ˆåŠ" class="headerlink" title="Appæƒ³ç”¨httpæ€ä¹ˆåŠ"></a>Appæƒ³ç”¨httpæ€ä¹ˆåŠ</h3><p>æ–°ç‰ˆxcodeå·²ç»é»˜è®¤é¡¹ç›®ä½¿ç”¨HTTPSï¼Œæƒ³è¦ç”¨å›httpï¼Œåªéœ€åœ¨<code>info.plist</code> æ·»åŠ keyï¼š<code>NSAppTransportSecurity</code> value:<code>Dictionary</code>ï¼Œåœ¨<code>dictionary</code>ä¸‹é¢æ·»åŠ <code>NSAllowsArbitraryLoads=YES</code>çš„é”®å€¼å¯¹å³å¯</p>
<h3 id="Xcode-8é»˜è®¤æ‰“å°äº†ä¸€å †æ— ç”¨çš„logï¼Œæ€ä¹ˆåŠï¼Ÿ"><a href="#Xcode-8é»˜è®¤æ‰“å°äº†ä¸€å †æ— ç”¨çš„logï¼Œæ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="Xcode 8é»˜è®¤æ‰“å°äº†ä¸€å †æ— ç”¨çš„logï¼Œæ€ä¹ˆåŠï¼Ÿ"></a>Xcode 8é»˜è®¤æ‰“å°äº†ä¸€å †æ— ç”¨çš„logï¼Œæ€ä¹ˆåŠï¼Ÿ</h3><p>åœ¨Xcodeé€‰é¡¹ä¸­ä¾æ¬¡é€‰æ‹© Product -&gt; Scheme -&gt; Edit Schemeï¼Œè°ƒå‡ºå·¥ç¨‹Schemeç¼–è¾‘é¢æ¿ï¼›æˆ–è€…ä½¿ç”¨å¿«æ·é”® <code>Shift+Command+,</code> è°ƒå‡ºSchemeç¼–è¾‘é¢æ¿ã€‚</p>
<p>é€‰ä¸­Runé€‰é¡¹ï¼Œåœ¨<code>Environment Variables</code>é‡Œé¢æ·»åŠ  <code>OS_ACTIVITY_MODE=Disable</code>ï¼Œå³å¯å‘Šåˆ«å¤šä½™çš„æ—¥å¿—ä¿¡æ¯ã€‚</p>
<p>ä½†æ˜¯çœŸæœºè°ƒè¯•çš„è¯ï¼ŒNSLogæ—¥å¿—å¹¶ä¸ä¼šå‡ºç°ï¼Œé‚£æˆ‘ä»¬å°±åªç”¨å®å®šä¹‰ä»£æ›¿ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="type">CCLog</span>(...) printf(<span class="string">"%f %s\n"</span>,[[<span class="type">NSDate</span> date] timeIntervalSince1970],[[<span class="type">NSString</span> stringWithFormat:__VA_ARGS__] <span class="type">UTF8String</span>]);</span><br></pre></td></tr></table></figure>

<h3 id="tableView-Cellåˆ†å‰²çº¿ä½ç½®"><a href="#tableView-Cellåˆ†å‰²çº¿ä½ç½®" class="headerlink" title="tableView Cellåˆ†å‰²çº¿ä½ç½®"></a>tableView Cellåˆ†å‰²çº¿ä½ç½®</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- (void)tableView:(<span class="type">UITableView</span> *)tableView willDisplayCell:(<span class="type">UITableViewCell</span> *)cell forRowAtIndexPath:(<span class="type">NSIndexPath</span> *)indexPath&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Remove separator inset</span></span><br><span class="line">    <span class="keyword">if</span> ([cell respondsToSelector:@selector(setSeparatorInset:)]) &#123;</span><br><span class="line">        [cell setSeparatorInset:<span class="type">UIEdgeInsetsMake</span>(<span class="number">0</span>, tableView.frame.size.width, <span class="number">0</span>, <span class="number">0</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Prevent the cell from inheriting the Table View's margin settings</span></span><br><span class="line">    <span class="keyword">if</span> ([cell respondsToSelector:@selector(setPreservesSuperviewLayoutMargins:)]) &#123;</span><br><span class="line">        [cell setPreservesSuperviewLayoutMargins:<span class="type">NO</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Explictly set your cell's layout margins</span></span><br><span class="line">    <span class="keyword">if</span> ([cell respondsToSelector:@selector(setLayoutMargins:)]) &#123;</span><br><span class="line">        [cell setLayoutMargins:<span class="type">UIEdgeInsetsMake</span>(<span class="number">0</span>, tableView.frame.size.width, <span class="number">0</span>, <span class="number">0</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="å¦‚ä½•å®ç°æ–œçº¹èƒŒæ™¯"><a href="#å¦‚ä½•å®ç°æ–œçº¹èƒŒæ™¯" class="headerlink" title="å¦‚ä½•å®ç°æ–œçº¹èƒŒæ™¯"></a>å¦‚ä½•å®ç°æ–œçº¹èƒŒæ™¯</h3><p>é¡¹ç›®ä¸­éœ€è¦å®ç°è¿™æ ·çš„æ•ˆæœï¼š<br><img src="/assets/images/stripe.png" alt=""></p>
<p>æ¯ä¸ªåŠå°æ—¶åŒºé—´éœ€è¦æ–œçº¹èƒŒæ™¯å¡«å……ï¼Œå¯ä»¥ç”¨UIViewæˆ–è€…CALayerå®ç°ã€‚<br>UIViewå®ç°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> - (void)drawRect:(<span class="type">CGRect</span>)rect &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–å½“å‰context</span></span><br><span class="line">    <span class="type">CGFloat</span> width = <span class="keyword">self</span>.frame.size.width;</span><br><span class="line">    <span class="type">CGFloat</span> height = <span class="keyword">self</span>.frame.size.height;</span><br><span class="line">    <span class="type">CGContextRef</span> ctx = <span class="type">UIGraphicsGetCurrentContext</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”»çŸ©å½¢ï¼Œå¡«å……èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="type">CGContextAddRect</span>(ctx, <span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, width, height));</span><br><span class="line">    [[<span class="type">UIColor</span> colorWithHex:@<span class="string">"#e9e9e9"</span>] <span class="keyword">set</span>];</span><br><span class="line">    <span class="type">CGContextFillPath</span>(ctx);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç”»æ–œçº¹çº¿æ¡</span></span><br><span class="line">    <span class="type">CGFloat</span> offset = <span class="number">50</span>;</span><br><span class="line">    [[<span class="type">UIColor</span> colorWithHex:@<span class="string">"#dadada"</span>] <span class="keyword">set</span>];</span><br><span class="line">    <span class="type">NSInteger</span> <span class="built_in">count</span> = ceilf((width + offset) * <span class="number">1</span>.0f / <span class="number">5.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">NSMutableArray</span> *startPoints = [<span class="type">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; <span class="built_in">count</span>; i ++)&#123;</span><br><span class="line">        <span class="type">CGPoint</span> startPoint = <span class="type">CGPointMake</span>(<span class="number">5</span> * i - offset, height);</span><br><span class="line">        <span class="type">NSValue</span> *value = [<span class="type">NSValue</span> valueWithCGPoint:startPoint];</span><br><span class="line">        [startPoints addObject:value];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">NSMutableArray</span> *endPoints = [<span class="type">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; <span class="built_in">count</span>; i ++)&#123;</span><br><span class="line">        <span class="type">CGPoint</span> endPoint = <span class="type">CGPointMake</span>(<span class="number">5</span> * i, <span class="number">0</span>);</span><br><span class="line">        <span class="type">NSValue</span> *value = [<span class="type">NSValue</span> valueWithCGPoint:endPoint];</span><br><span class="line">        [endPoints addObject:value];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; startPoints.<span class="built_in">count</span>; i ++)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">CGPoint</span> startPoint = [[startPoints objectAtIndex:i] <span class="type">CGPointValue</span>];</span><br><span class="line">        <span class="type">CGPoint</span> endPoint = [[endPoints objectAtIndex:i] <span class="type">CGPointValue</span>];</span><br><span class="line">        <span class="type">CGContextMoveToPoint</span>(ctx, startPoint.x, startPoint.y);</span><br><span class="line">        <span class="type">CGContextAddLineToPoint</span>(ctx, endPoint.x, endPoint.y);</span><br><span class="line">        <span class="type">CGContextStrokePath</span>(ctx);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CALayerå®ç°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">CAShapeLayer</span> *)invalidLayerWidthFrame:(<span class="type">CGRect</span>)frame&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºCGPath</span></span><br><span class="line">    <span class="type">CGMutablePathRef</span> path = <span class="type">CGPathCreateMutable</span>();</span><br><span class="line">    <span class="comment">// åˆ›å»ºlayerï¼Œè®¾ç½®layerç»˜åˆ¶é¢œè‰²</span></span><br><span class="line">    <span class="type">CAShapeLayer</span> *oneLayer = [<span class="type">CAShapeLayer</span> layer];</span><br><span class="line">    oneLayer.fillColor = [<span class="type">UIColor</span> whiteColor].<span class="type">CGColor</span>;</span><br><span class="line">    oneLayer.strokeColor = [<span class="type">UIColor</span> blueColor].<span class="type">CGColor</span>;</span><br><span class="line">    oneLayer.lineWidth = <span class="number">1</span>.0f;</span><br><span class="line">    oneLayer.masksToBounds = <span class="type">YES</span>;</span><br><span class="line">    oneLayer.frame = frame;</span><br><span class="line">    oneLayer.backgroundColor = [<span class="type">UIColor</span> lightGrayColor].<span class="type">CGColor</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å®šä¹‰æ–œçº¿é—´è·ã€èµ·å§‹ç‚¹ä¸ç»ˆæ­¢ç‚¹Xè½´åç§»é‡</span></span><br><span class="line">    <span class="type">CGFloat</span> offsetX = <span class="number">50</span>;</span><br><span class="line">    <span class="type">CGFloat</span> spaceX = <span class="number">5</span>;</span><br><span class="line">    <span class="type">NSInteger</span> <span class="built_in">count</span> = ceilf((frame.size.width + offsetX) * <span class="number">1</span>.0f / spaceX);</span><br><span class="line">    </span><br><span class="line">    <span class="type">NSMutableArray</span> *startPoints = [<span class="type">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; <span class="built_in">count</span>; i ++)&#123;</span><br><span class="line">        <span class="type">CGPoint</span> startPoint = <span class="type">CGPointMake</span>(spaceX * i - offsetX, frame.size.height);</span><br><span class="line">        <span class="type">NSValue</span> *value = [<span class="type">NSValue</span> valueWithCGPoint:startPoint];</span><br><span class="line">        [startPoints addObject:value];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">NSMutableArray</span> *endPoints = [<span class="type">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; <span class="built_in">count</span>; i ++)&#123;</span><br><span class="line">        <span class="type">CGPoint</span> endPoint = <span class="type">CGPointMake</span>(spaceX * i, <span class="number">0</span>);</span><br><span class="line">        <span class="type">NSValue</span> *value = [<span class="type">NSValue</span> valueWithCGPoint:endPoint];</span><br><span class="line">        [endPoints addObject:value];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; startPoints.<span class="built_in">count</span>; i ++)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">CGPoint</span> startPoint = [[startPoints objectAtIndex:i] <span class="type">CGPointValue</span>];</span><br><span class="line">        <span class="type">CGPoint</span> endPoint = [[endPoints objectAtIndex:i] <span class="type">CGPointValue</span>];</span><br><span class="line">        <span class="type">CGPathMoveToPoint</span>(path, <span class="type">NULL</span>, startPoint.x, startPoint.y);</span><br><span class="line">        <span class="type">CGPathAddLineToPoint</span>(path, <span class="type">NULL</span>, endPoint.x, endPoint.y);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    oneLayer.path = path;</span><br><span class="line">    <span class="keyword">return</span> oneLayer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Xcodeå¯åŠ¨å›¾æ­£ç¡®æ·»åŠ åä¸æ˜¾ç¤º"><a href="#Xcodeå¯åŠ¨å›¾æ­£ç¡®æ·»åŠ åä¸æ˜¾ç¤º" class="headerlink" title="Xcodeå¯åŠ¨å›¾æ­£ç¡®æ·»åŠ åä¸æ˜¾ç¤º"></a>Xcodeå¯åŠ¨å›¾æ­£ç¡®æ·»åŠ åä¸æ˜¾ç¤º</h3><p>å…ˆåˆ©ç”¨Assetsæ–¹å¼æ·»åŠ å¯åŠ¨å›¾ï¼š</p>
<p>1ã€åœ¨Assets.xcassets -&gt; LaunchImageå›¾ç‰‡é›†ä¸­æ·»åŠ å„ç§åˆ†è¾¨ç‡å¯åŠ¨å›¾ç‰‡</p>
<p>2ã€å¦‚æœ‰<code>LaunchScreen.storyboard</code>æ–‡ä»¶ï¼Œå…³é—­Xcode Generalé€‰é¡¹å¡ä¸­ <code>use as Launch Screen</code>é€‰é¡¹</p>
<p>3ã€<code>General</code>é€‰é¡¹æ”¹åŠ¨ï¼Œ<code>Launch Images Source</code> æ”¹ä¸º <code>LaunchImageå›¾ç‰‡é›†</code>ï¼›<code>Launch Screen File</code> ç½®ç©ºï¼›<br>æ”¹åŠ¨åé‡å¯ä¸€ä¸‹Xcodeæ‰èƒ½é€‰æ‹©å·²æœ‰çš„å¯åŠ¨å›¾ç‰‡é›†ï¼Œç„¶ååˆ é™¤å·²å®‰è£…çš„Appå†è¿è¡Œæ‰èƒ½çœ‹åˆ°æ•ˆæœğŸ˜‚</p>
<h3 id="è“ç‰™ä¸èƒ½è‡ªåŠ¨æ‰«æ"><a href="#è“ç‰™ä¸èƒ½è‡ªåŠ¨æ‰«æ" class="headerlink" title="è“ç‰™ä¸èƒ½è‡ªåŠ¨æ‰«æ"></a>è“ç‰™ä¸èƒ½è‡ªåŠ¨æ‰«æ</h3><p>åˆ›å»ºå¥½<code>CBCentralManager</code> åéœ€è¦åœ¨<code>viewController</code> çš„ <code>viewDidAppear</code>æ—¶æ‰§è¡Œæ‰«æ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mCentralManager = [[<span class="type">CBCentralManager</span> alloc] initWithDelegate:<span class="keyword">self</span> queue:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(<span class="type">BOOL</span>)animated&#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">super</span> viewDidAppear:animated];</span><br><span class="line">    <span class="type">CBUUID</span> *serviceUUID = [<span class="type">CBUUID</span> <span class="type">UUIDWithString</span>:@<span class="string">"00001101-0000-0100-8000-00805F9B34FB"</span>];</span><br><span class="line">    <span class="type">NSArray</span> *servicesArr = [<span class="type">NSArray</span> arrayWithObjects:serviceUUID,<span class="literal">nil</span>];</span><br><span class="line">    [mCentralManager scanForPeripheralsWithServices:servicesArr options:@&#123;<span class="type">CBCentralManagerScanOptionAllowDuplicatesKey</span>:@<span class="type">NO</span>&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pod-update-è·å–ä¸åˆ°æœ€æ–°repo"><a href="#pod-update-è·å–ä¸åˆ°æœ€æ–°repo" class="headerlink" title="pod update è·å–ä¸åˆ°æœ€æ–°repo"></a>pod update è·å–ä¸åˆ°æœ€æ–°repo</h3><p>å…ˆåˆ é™¤æœ¬åœ°çš„reposï¼Œå†setupï¼Œç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -rf ~/.cocoapods/repos/master</span><br><span class="line">pod setup</span><br></pre></td></tr></table></figure>

<h3 id="iPhone-Xå¯¼èˆªæ å¤šäº†ä¸€æ¡çº¿"><a href="#iPhone-Xå¯¼èˆªæ å¤šäº†ä¸€æ¡çº¿" class="headerlink" title="iPhone Xå¯¼èˆªæ å¤šäº†ä¸€æ¡çº¿"></a>iPhone Xå¯¼èˆªæ å¤šäº†ä¸€æ¡çº¿</h3><p><img src="/assets/images/navi_line.png" alt=""></p>
<p>çœ‹äº†ä¸€ä¸‹å¯¼èˆªæ çš„viewå±‚çº§ï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆé«˜åº¦ä¸º1çš„viewï¼Œç„¶åçªç„¶é†’æ‚Ÿåˆ°ï¼Œå¯èƒ½æ˜¯å¯¼èˆªæ èƒŒæ™¯å›¾ç‰‡å°ºå¯¸çš„é—®é¢˜ï¼Œæ¢äº†é«˜åº¦ä¸º88çš„å›¾ç‰‡å°±æ²¡äº‹äº†ã€‚</p>
<h3 id="LaunchScreenåŠ è½½ä¸åˆ°å›¾ç‰‡"><a href="#LaunchScreenåŠ è½½ä¸åˆ°å›¾ç‰‡" class="headerlink" title="LaunchScreenåŠ è½½ä¸åˆ°å›¾ç‰‡"></a>LaunchScreenåŠ è½½ä¸åˆ°å›¾ç‰‡</h3><p>å°†éœ€è¦åŠ è½½çš„å›¾ç‰‡ï¼Œè½¬ä¸ºJPEGæ ¼å¼çš„å›¾ç‰‡ï¼Œæˆ–è€…tiffæ ¼å¼ï¼Œå…·ä½“åŸå› ä¸æ˜ï¼Œå¦‚æœå‡ºç°å¯åŠ¨æ— æ³•åŠ è½½ï¼Œåˆ é™¤APPé‡è£…ï¼Œæˆ–è€…é‡å¯æ‰‹æœºä¹Ÿå¯ä»¥è§£å†³</p>
<h3 id="ç½‘ç»œå›¾ç‰‡å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯¼è‡´sdwebimgageæ— æ³•åŠ è½½"><a href="#ç½‘ç»œå›¾ç‰‡å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯¼è‡´sdwebimgageæ— æ³•åŠ è½½" class="headerlink" title="ç½‘ç»œå›¾ç‰‡å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯¼è‡´sdwebimgageæ— æ³•åŠ è½½"></a>ç½‘ç»œå›¾ç‰‡å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯¼è‡´sdwebimgageæ— æ³•åŠ è½½</h3><p>éœ€è¦å°†URLä½¿ç”¨utf8ç¼–ç æ ¼å¼ä¸€ä¸‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// iOS 9 ä¹‹å‰</span></span><br><span class="line">imgUrl = \[urlStr stringByAddingPercentEscapesUsingEncoding:<span class="type">NSUTF8StringEncoding</span>];</span><br><span class="line"><span class="comment">// iOS 9 ä¹‹å</span></span><br><span class="line">imgUrl = \[urlStr stringByAddingPercentEncodingWithAllowedCharacters:\[<span class="type">NSCharacterSet</span> <span class="type">URLQueryAllowedCharacterSet</span>]];</span><br></pre></td></tr></table></figure>
<h3 id="SVN-version-is-locked"><a href="#SVN-version-is-locked" class="headerlink" title="SVN version is locked"></a>SVN version is locked</h3><p>ä»¥CornerStone ä¸ºä¾‹ï¼ŒworkingCopyï¼Œå³é”® -&gt; Clean</p>
<h3 id="SVN-æŠ¥é”™-â€œAn-error-occurred-while-contacting-the-repository-â€"><a href="#SVN-æŠ¥é”™-â€œAn-error-occurred-while-contacting-the-repository-â€" class="headerlink" title="SVN æŠ¥é”™ â€œAn error occurred while contacting the repository.â€"></a>SVN æŠ¥é”™ â€œAn error occurred while contacting the repository.â€</h3><p>åˆ é™¤é’¥åŒ™ä¸²ä¸­SVNç›¸å…³å¯†ç ï¼Œé‡å¯SVNå®¢æˆ·ç«¯ã€‚</p>
<h3 id="ScrollViewä»£ç†scrollViewDidScroll-å’ŒscrollViewDidEndScrollingAnimation-æ‰§è¡Œäº†åŒæ ·çš„ä¸šåŠ¡ä»£ç ï¼Œæ€ä¹ˆé˜²æ­¢æ‰§è¡Œå¤šæ¬¡å‘¢ï¼Ÿ"><a href="#ScrollViewä»£ç†scrollViewDidScroll-å’ŒscrollViewDidEndScrollingAnimation-æ‰§è¡Œäº†åŒæ ·çš„ä¸šåŠ¡ä»£ç ï¼Œæ€ä¹ˆé˜²æ­¢æ‰§è¡Œå¤šæ¬¡å‘¢ï¼Ÿ" class="headerlink" title="ScrollViewä»£ç†scrollViewDidScroll:å’ŒscrollViewDidEndScrollingAnimation:æ‰§è¡Œäº†åŒæ ·çš„ä¸šåŠ¡ä»£ç ï¼Œæ€ä¹ˆé˜²æ­¢æ‰§è¡Œå¤šæ¬¡å‘¢ï¼Ÿ"></a>ScrollViewä»£ç†scrollViewDidScroll:å’ŒscrollViewDidEndScrollingAnimation:æ‰§è¡Œäº†åŒæ ·çš„ä¸šåŠ¡ä»£ç ï¼Œæ€ä¹ˆé˜²æ­¢æ‰§è¡Œå¤šæ¬¡å‘¢ï¼Ÿ</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (void)scrollViewDidScroll:(<span class="type">UIScrollView</span> *)scrollView &#123;</span><br><span class="line">    <span class="comment">// å»æ‰§è¡Œdid end scroll animationï¼Œ</span></span><br><span class="line">    [<span class="type">NSObject</span> cancelPreviousPerformRequestsWithTarget:<span class="keyword">self</span>];</span><br><span class="line">    [<span class="keyword">self</span> performSelector:@selector(scrollViewDidEndScrollingAnimation:) withObject:scrollView afterDelay:<span class="number">0.1</span>];</span><br><span class="line">&#125;</span><br><span class="line">- (void)scrollViewDidEndScrollingAnimation:(<span class="type">UIScrollView</span> *)scrollView &#123;</span><br><span class="line">    [<span class="type">NSObject</span> cancelPreviousPerformRequestsWithTarget:<span class="keyword">self</span>];</span><br><span class="line">    <span class="comment">// your code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Xcodeä½¿ç”¨cocoapodsæ‰“åŒ…å‡ºæ¥çš„ipaåŒ…é‡Œé¢åŒ…å«äº†ç¬¬ä¸‰æ–¹åº“ï¼Œå¢åŠ äº†åŒ…ä½“ç§¯ã€‚"><a href="#Xcodeä½¿ç”¨cocoapodsæ‰“åŒ…å‡ºæ¥çš„ipaåŒ…é‡Œé¢åŒ…å«äº†ç¬¬ä¸‰æ–¹åº“ï¼Œå¢åŠ äº†åŒ…ä½“ç§¯ã€‚" class="headerlink" title="Xcodeä½¿ç”¨cocoapodsæ‰“åŒ…å‡ºæ¥çš„ipaåŒ…é‡Œé¢åŒ…å«äº†ç¬¬ä¸‰æ–¹åº“ï¼Œå¢åŠ äº†åŒ…ä½“ç§¯ã€‚"></a>Xcodeä½¿ç”¨cocoapodsæ‰“åŒ…å‡ºæ¥çš„ipaåŒ…é‡Œé¢åŒ…å«äº†ç¬¬ä¸‰æ–¹åº“ï¼Œå¢åŠ äº†åŒ…ä½“ç§¯ã€‚</h3><p>åˆ æ‰podfileé‡Œé¢çš„use_frame!</p>
<h3 id="webviewæ¿€æ´»é”®ç›˜åï¼Œç³»ç»Ÿæ”¶èµ·é”®ç›˜ä¼šå¯¼è‡´ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ¯”å¦‚ç•Œé¢å¡æ­»ï¼Œwebå†…å®¹æ¶ˆå¤±ç­‰è¯¡å¼‚ç°è±¡"><a href="#webviewæ¿€æ´»é”®ç›˜åï¼Œç³»ç»Ÿæ”¶èµ·é”®ç›˜ä¼šå¯¼è‡´ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ¯”å¦‚ç•Œé¢å¡æ­»ï¼Œwebå†…å®¹æ¶ˆå¤±ç­‰è¯¡å¼‚ç°è±¡" class="headerlink" title="webviewæ¿€æ´»é”®ç›˜åï¼Œç³»ç»Ÿæ”¶èµ·é”®ç›˜ä¼šå¯¼è‡´ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ¯”å¦‚ç•Œé¢å¡æ­»ï¼Œwebå†…å®¹æ¶ˆå¤±ç­‰è¯¡å¼‚ç°è±¡"></a>webviewæ¿€æ´»é”®ç›˜åï¼Œç³»ç»Ÿæ”¶èµ·é”®ç›˜ä¼šå¯¼è‡´ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ¯”å¦‚ç•Œé¢å¡æ­»ï¼Œwebå†…å®¹æ¶ˆå¤±ç­‰è¯¡å¼‚ç°è±¡</h3><p>è‡ªå·±ä¸»åŠ¨æ”¶èµ·é”®ç›˜</p>
<h3 id="TabBarçš„æœªé€‰ä¸­itemé¢œè‰²è¢«æ¸²æŸ“ä¸ºç°è‰²äº†"><a href="#TabBarçš„æœªé€‰ä¸­itemé¢œè‰²è¢«æ¸²æŸ“ä¸ºç°è‰²äº†" class="headerlink" title="TabBarçš„æœªé€‰ä¸­itemé¢œè‰²è¢«æ¸²æŸ“ä¸ºç°è‰²äº†"></a>TabBarçš„æœªé€‰ä¸­itemé¢œè‰²è¢«æ¸²æŸ“ä¸ºç°è‰²äº†</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨åŸæ¥çš„æ¸²æŸ“</span></span><br><span class="line"><span class="type">UIImage</span> *originImage = [[<span class="type">UIImage</span> imageWithName:@â€œâ€] imageWithRenderingMode:<span class="type">UIImageRenderingModeAlwaysOriginal</span>];</span><br><span class="line"><span class="type">UITabBarItem</span> *barItem = [<span class="type">UITabBarItem</span> alloc] initWithTitle:@â€œtitleâ€ image:originImage selectedImage:selectedImage];</span><br></pre></td></tr></table></figure>
<h3 id="xcode-select-error-tool-â€˜xcodebuildâ€™-requires-Xcode"><a href="#xcode-select-error-tool-â€˜xcodebuildâ€™-requires-Xcode" class="headerlink" title="xcode-select: error: tool â€˜xcodebuildâ€™ requires Xcode"></a>xcode-select: error: tool â€˜xcodebuildâ€™ requires Xcode</h3><p>xcodebuildéœ€è¦è°ƒç”¨Xcodeå»æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯xcode-selectæŒ‡å‘çš„è·¯å¾„æ˜¯/Library/Developer/CommandLineToolsï¼Œä¸æ˜¯Xcodeè·¯å¾„ï¼Œæ‰€ä»¥å°†è·¯å¾„åˆ‡æ¢åˆ°Xcodeè·¯å¾„ä¸‹å°±OKäº†ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/18/iOS-tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/18/iOS-tips/" class="post-title-link" itemprop="url">iOSå¼€å‘å°æŠ€å·§</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-04-18 00:00:00" itemprop="dateCreated datePublished" datetime="2018-04-18T00:00:00+00:00">2018-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:05" itemprop="dateModified" datetime="2020-04-26T05:59:05+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">iOSå¼€å‘</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ¬æ–‡æŒç»­æ›´æ–°ï¼Œä¸»è¦è®°å½•è‡ªå·±åœ¨iOSå¼€å‘è¿‡ç¨‹ä¸­ç”¨åˆ°çš„ä¸€äº›å°æŠ€å·§ï¼ŒåŠ©åŠ›å¿«é€Ÿå¼€å‘</p>
<h3 id="UIButtonåŠ¨æ€è®¾ç½®æ–‡å­—å‡ºç°é—ªçƒ"><a href="#UIButtonåŠ¨æ€è®¾ç½®æ–‡å­—å‡ºç°é—ªçƒ" class="headerlink" title="UIButtonåŠ¨æ€è®¾ç½®æ–‡å­—å‡ºç°é—ªçƒ"></a>UIButtonåŠ¨æ€è®¾ç½®æ–‡å­—å‡ºç°é—ªçƒ</h3><p>Button typeä¸è¦ä½¿ç”¨systemï¼Œè¦ç”¨custom</p>
<h3 id="tableViewé™¤æ‰å¤šä½™ç©ºç™½è¡Œï¼š"><a href="#tableViewé™¤æ‰å¤šä½™ç©ºç™½è¡Œï¼š" class="headerlink" title="tableViewé™¤æ‰å¤šä½™ç©ºç™½è¡Œï¼š"></a>tableViewé™¤æ‰å¤šä½™ç©ºç™½è¡Œï¼š</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tableView.tableFooterView = [<span class="type">UIView</span> new];</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰leftBarButtonItemå¯¼è‡´å·¦æ»‘è¿”å›æ‰‹åŠ¿å¤±æ•ˆ"><a href="#è‡ªå®šä¹‰leftBarButtonItemå¯¼è‡´å·¦æ»‘è¿”å›æ‰‹åŠ¿å¤±æ•ˆ" class="headerlink" title="è‡ªå®šä¹‰leftBarButtonItemå¯¼è‡´å·¦æ»‘è¿”å›æ‰‹åŠ¿å¤±æ•ˆ"></a>è‡ªå®šä¹‰leftBarButtonItemå¯¼è‡´å·¦æ»‘è¿”å›æ‰‹åŠ¿å¤±æ•ˆ</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.navigationItem.leftBarButtonItem = [[<span class="type">UIBarButtonItem</span> alloc] initWithImage:img style:<span class="type">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:@selector(onBack:)];</span><br><span class="line"><span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.delegate = (id &lt;<span class="type">UIGestureRecognizerDelegate</span>&gt; )<span class="keyword">self</span>;</span><br></pre></td></tr></table></figure>

<h3 id="ViewControllerä¸­çš„scrollViewå‡ºç°è«åçš„frameä½ç§»æˆ–è€…contentOffsetæœ‰åå·®"><a href="#ViewControllerä¸­çš„scrollViewå‡ºç°è«åçš„frameä½ç§»æˆ–è€…contentOffsetæœ‰åå·®" class="headerlink" title="ViewControllerä¸­çš„scrollViewå‡ºç°è«åçš„frameä½ç§»æˆ–è€…contentOffsetæœ‰åå·®"></a>ViewControllerä¸­çš„scrollViewå‡ºç°è«åçš„frameä½ç§»æˆ–è€…contentOffsetæœ‰åå·®</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// iOS 11 ä¹‹å‰</span></span><br><span class="line"><span class="keyword">self</span>.automaticallyAdjustScrollViewInsets = <span class="type">NO</span>;</span><br><span class="line"><span class="keyword">self</span>.edgesForExtendedLayout = <span class="type">UIRectEdgeNone</span>;</span><br><span class="line"><span class="comment">// iOS 11</span></span><br><span class="line">scrollView.contentInsetAdjustmentBehavior = <span class="type">UIScrollViewContentInsetAdjustmentNever</span>;</span><br></pre></td></tr></table></figure>


<h3 id="é¡µé¢æ»šåŠ¨æ—¶ï¼Œéšè—navigationbar"><a href="#é¡µé¢æ»šåŠ¨æ—¶ï¼Œéšè—navigationbar" class="headerlink" title="é¡µé¢æ»šåŠ¨æ—¶ï¼Œéšè—navigationbar"></a>é¡µé¢æ»šåŠ¨æ—¶ï¼Œéšè—navigationbar</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigationController.hidesBarsOnSwipe = <span class="type">YES</span>;</span><br></pre></td></tr></table></figure>


<h3 id="æ‹‰ä¼¸å›¾ç‰‡çš„æ—¶å€™æ€ä¹ˆæ‰èƒ½è®©å›¾ç‰‡ä¸å˜å½¢"><a href="#æ‹‰ä¼¸å›¾ç‰‡çš„æ—¶å€™æ€ä¹ˆæ‰èƒ½è®©å›¾ç‰‡ä¸å˜å½¢" class="headerlink" title="æ‹‰ä¼¸å›¾ç‰‡çš„æ—¶å€™æ€ä¹ˆæ‰èƒ½è®©å›¾ç‰‡ä¸å˜å½¢"></a>æ‹‰ä¼¸å›¾ç‰‡çš„æ—¶å€™æ€ä¹ˆæ‰èƒ½è®©å›¾ç‰‡ä¸å˜å½¢</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIImage</span> *image = [[<span class="type">UIImage</span> imageNamed:@<span class="string">"xxx"</span>] stretchableImageWithLeftCapWidth:<span class="number">10</span> topCapHeight:<span class="number">10</span>];</span><br></pre></td></tr></table></figure>

<h3 id="æŠŠtableviewé‡Œcellçš„å°å¯¹å‹¾çš„é¢œè‰²æ”¹æˆåˆ«çš„é¢œè‰²"><a href="#æŠŠtableviewé‡Œcellçš„å°å¯¹å‹¾çš„é¢œè‰²æ”¹æˆåˆ«çš„é¢œè‰²" class="headerlink" title="æŠŠtableviewé‡Œcellçš„å°å¯¹å‹¾çš„é¢œè‰²æ”¹æˆåˆ«çš„é¢œè‰²"></a>æŠŠtableviewé‡Œcellçš„å°å¯¹å‹¾çš„é¢œè‰²æ”¹æˆåˆ«çš„é¢œè‰²</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tableView.tintColor = [<span class="type">UIColor</span> redColor];</span><br></pre></td></tr></table></figure>

<h3 id="Navigationbarå¼„æˆé€æ˜çš„è€Œä¸æ˜¯å¸¦æ¨¡ç³Šçš„æ•ˆæœ"><a href="#Navigationbarå¼„æˆé€æ˜çš„è€Œä¸æ˜¯å¸¦æ¨¡ç³Šçš„æ•ˆæœ" class="headerlink" title="Navigationbarå¼„æˆé€æ˜çš„è€Œä¸æ˜¯å¸¦æ¨¡ç³Šçš„æ•ˆæœ"></a>Navigationbarå¼„æˆé€æ˜çš„è€Œä¸æ˜¯å¸¦æ¨¡ç³Šçš„æ•ˆæœ</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span>.navigationController.navigationBar setBackgroundImage:[<span class="type">UIImage</span> new] forBarMetrics:<span class="type">UIBarMetricsDefault</span>];</span><br><span class="line"><span class="keyword">self</span>.navigationController.navigationBar.shadowImage = [<span class="type">UIImage</span> new];</span><br><span class="line"><span class="keyword">self</span>.navigationController.navigationBar.translucent = <span class="type">YES</span>;</span><br></pre></td></tr></table></figure>

<h3 id="æ”¹å˜UITextField-placeholderçš„é¢œè‰²å’Œä½ç½®"><a href="#æ”¹å˜UITextField-placeholderçš„é¢œè‰²å’Œä½ç½®" class="headerlink" title="æ”¹å˜UITextField placeholderçš„é¢œè‰²å’Œä½ç½®"></a>æ”¹å˜UITextField placeholderçš„é¢œè‰²å’Œä½ç½®</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»§æ‰¿UITextField é‡å†™</span></span><br><span class="line">- (void)drawPlaceholderInRect:(<span class="type">CGRect</span>)rect &#123;</span><br><span class="line">    [[<span class="type">UIColor</span> blueColor] setFill];</span><br><span class="line">    [<span class="keyword">self</span>.placeholder drawInRect:rect withFont:<span class="keyword">self</span>.font lineBreakMode:<span class="type">UILineBreakModeTailTruncation</span> alignment:<span class="keyword">self</span>.textAlignment];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰NavigationBarçš„titleView"><a href="#è‡ªå®šä¹‰NavigationBarçš„titleView" class="headerlink" title="è‡ªå®šä¹‰NavigationBarçš„titleView"></a>è‡ªå®šä¹‰NavigationBarçš„titleView</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIView</span> *titleView = [<span class="type">UIView</span> alloc] <span class="keyword">init</span>];</span><br><span class="line"><span class="keyword">self</span>.navigationItem.titleView = titleView;</span><br><span class="line"><span class="comment">// iOS 11 å¦‚æœtitleViewä¸Šçš„buttonä¸å“åº”ï¼Œè‡ªå®šä¹‰titleViewï¼ŒåŠ å…¥@property (nonatomic, assign) CGSize intrinsicContentSize;</span></span><br><span class="line"><span class="type">CustomTitleView</span> *titleView = [<span class="type">CustomTitleView</span> alloc] <span class="keyword">init</span>];</span><br><span class="line">titleView.intrinsicContentSize = <span class="type">CGSizeMake</span>(<span class="number">100</span>,<span class="number">44</span>);</span><br><span class="line"><span class="keyword">self</span>.navigationItem.titleView = titleView;</span><br></pre></td></tr></table></figure>

<h3 id="UIScorllView-ContentSize-é€šè¿‡æ·»åŠ Masonry-layoutçº¦æŸç¡®å®šå°ºå¯¸"><a href="#UIScorllView-ContentSize-é€šè¿‡æ·»åŠ Masonry-layoutçº¦æŸç¡®å®šå°ºå¯¸" class="headerlink" title="UIScorllView ContentSize é€šè¿‡æ·»åŠ Masonry layoutçº¦æŸç¡®å®šå°ºå¯¸"></a>UIScorllView ContentSize é€šè¿‡æ·»åŠ Masonry layoutçº¦æŸç¡®å®šå°ºå¯¸</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°å»ºscrollView æ·»åŠ çº¦æŸç¡®å®šframe</span></span><br><span class="line"><span class="type">UIScrollView</span> *scrollView = [[<span class="type">UIScrollView</span> alloc] <span class="keyword">init</span>]; </span><br><span class="line">[<span class="keyword">self</span>.view addSubview:scrollView]; </span><br><span class="line">[scrollView mas_makeConstraints:^(<span class="type">MASConstraintMaker</span> *make) &#123; </span><br><span class="line">    make.edges.equalTo(<span class="keyword">self</span>.view);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// æ·»åŠ containeråˆ°scrollViewä¸Šï¼Œæ·»åŠ containeråˆ°scrollviewçš„å„è¾¹è¾¹è·ï¼Œåœ¨é€šè¿‡æŒ‡å®šcontainerå®½é«˜å†³å®šcontentSize</span></span><br><span class="line"><span class="type">UIView</span> *containerView = [[<span class="type">UIView</span> alloc] <span class="keyword">init</span>];</span><br><span class="line">[scrollView addSubview:containerView];</span><br><span class="line">[containerView mas_makeConstraints:^(<span class="type">MASConstraintMaker</span> *make) &#123;</span><br><span class="line"><span class="comment">// æŒ‡å®šcontainerä¸scrollViewè¾¹è·ï¼Œå¾ˆå…³é”®</span></span><br><span class="line">    make.edges.equalTo(scrollView);</span><br><span class="line"><span class="comment">// æŒ‡å®šcontainerå®½åº¦</span></span><br><span class="line">    make.width.equalTo(scrollView);</span><br><span class="line"><span class="comment">// æŒ‡å®šcontaineré«˜åº¦ï¼Œ+1ä¿è¯scrollViewçš„bounds</span></span><br><span class="line">    make.height.equalTo(scrollView).offset(<span class="number">1</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h3 id="WebView-è·å–HTMLçš„title"><a href="#WebView-è·å–HTMLçš„title" class="headerlink" title="WebView è·å–HTMLçš„title"></a>WebView è·å–HTMLçš„title</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)webView:(<span class="type">WKWebView</span> *)webView didFinishNavigation:(null_unspecified <span class="type">WKNavigation</span> *)navigation&#123;</span><br><span class="line">  </span><br><span class="line">    [webView evaluateJavaScript:@<span class="string">"document.title"</span> completionHandler:^(id _Nullable obj, <span class="type">NSError</span> * _Nullable error) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.title = [<span class="type">NSString</span> stringWithFormat:@<span class="string">"%@"</span>,obj];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç›‘å¬UITextFieldå†…å®¹å˜åŒ–"><a href="#ç›‘å¬UITextFieldå†…å®¹å˜åŒ–" class="headerlink" title="ç›‘å¬UITextFieldå†…å®¹å˜åŒ–"></a>ç›‘å¬UITextFieldå†…å®¹å˜åŒ–</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[textField addTarget:<span class="keyword">self</span> action:@selector(textfiledEditChanged:) forControlEvents:<span class="type">UIControlEventEditingChanged</span>];</span><br></pre></td></tr></table></figure>

<h3 id="Animationæ”¹å˜constraint"><a href="#Animationæ”¹å˜constraint" class="headerlink" title="Animationæ”¹å˜constraint"></a>Animationæ”¹å˜constraint</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">constraint.constant = <span class="number">100</span>;</span><br><span class="line">[<span class="type">UIView</span> animationWithDuration:.3f animations:^&#123;</span><br><span class="line">  [<span class="keyword">self</span>.view layoutIfNeeded];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h3 id="ä¸é€šè¿‡Xcodeæ‰“åŒ…ipa"><a href="#ä¸é€šè¿‡Xcodeæ‰“åŒ…ipa" class="headerlink" title="ä¸é€šè¿‡Xcodeæ‰“åŒ…ipa"></a>ä¸é€šè¿‡Xcodeæ‰“åŒ…ipa</h3><p>Xcode <code>archive</code>åï¼Œåœ¨xcodeçš„<code>Archives</code>ä¸­æ‰¾åˆ°ç›¸åº”çš„<code>ArchiveåŒ…</code>ï¼Œæ˜¾ç¤ºåŒ…å†…å®¹ï¼Œåœ¨<code>Products/Applications/</code>è·¯å¾„ä¸‹é¢æ‰¾åˆ°åº”ç”¨ç¨‹åºï¼Œåœ¨æ¡Œé¢æ–°å»º<code>Payload</code>æ–‡ä»¶å¤¹ï¼Œå°†åº”ç”¨ç¨‹åºæ‹–å…¥<code>Payload</code>æ–‡ä»¶å¤¹ï¼Œå‹ç¼©ï¼Œæ”¹å‹ç¼©åŒ…åç¼€ä¸º<code>.ipa</code>ã€‚</p>
<h3 id="XCodeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“"><a href="#XCodeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“" class="headerlink" title="XCodeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“"></a>XCodeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“</h3><ul>
<li>1ã€æ·»åŠ è‡ªå®šä¹‰å­—ä½“.ttfåˆ°XCodeå·¥ç¨‹ï¼›</li>
<li>2ã€info.plistæ·»åŠ key:<code>&lt;Fonts provided by application.</code>ï¼Œvalueç±»å‹ä¸º<code>Array</code>ï¼Œæ·»åŠ è‡ªå®šä¹‰å­—ä½“ååˆ°Arrayï¼›</li>
<li>3ã€ç¡®ä¿Build Phases -&gt; Copy Bundle Resources é‡Œé¢åŒ…å«ä½ çš„å­—ä½“æ–‡ä»¶ï¼Œä¸ç„¶ä¸ä¼šæ˜¾ç¤ºå­—ä½“</li>
<li>4ã€ä»£ç è°ƒç”¨<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIFont</span> *digitFont = [<span class="type">UIFont</span> fontWithName:@<span class="string">"Impact"</span> size:<span class="number">38</span>];</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Xcode-å¿½ç•¥ä¸€äº›åºŸé™¤æ¥å£è­¦å‘Š"><a href="#Xcode-å¿½ç•¥ä¸€äº›åºŸé™¤æ¥å£è­¦å‘Š" class="headerlink" title="Xcode å¿½ç•¥ä¸€äº›åºŸé™¤æ¥å£è­¦å‘Š"></a>Xcode å¿½ç•¥ä¸€äº›åºŸé™¤æ¥å£è­¦å‘Š</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">//-Wunused-variable å˜é‡æœªä½¿ç”¨ -Wdeprecated-declarations ä½¿ç”¨åºŸå¼ƒæ–¹æ³• -Wdocumentation æ–‡æ¡£æ³¨é‡Š </span></span><br><span class="line">pragma clang diagnostic push</span><br><span class="line">pragma clang diagnostic ignored <span class="string">"-Wdeprecated-declarations"</span></span><br><span class="line">Â Â  <span class="comment">//code åºŸå¼ƒçš„æ–¹æ³•</span></span><br><span class="line">pragma clang diagnostic pop</span><br></pre></td></tr></table></figure>

<h3 id="TableView-ç‚¹å‡»ç©ºç™½æ”¶èµ·é”®ç›˜"><a href="#TableView-ç‚¹å‡»ç©ºç™½æ”¶èµ·é”®ç›˜" class="headerlink" title="TableView ç‚¹å‡»ç©ºç™½æ”¶èµ·é”®ç›˜"></a>TableView ç‚¹å‡»ç©ºç™½æ”¶èµ·é”®ç›˜</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UITapGestureRecognizer</span> \*tableViewGesture = \[\[<span class="type">UITapGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:@selector(tableViewTouchInSide)];</span><br><span class="line"><span class="comment">//æ˜¯å¦å–æ¶ˆç‚¹å‡»å¤„çš„å…¶ä»–action</span></span><br><span class="line">tableViewGesture.cancelsTouchesInView = <span class="type">NO</span>;</span><br><span class="line">[<span class="keyword">self</span>.subTableView addGestureRecognizer:tableViewGesture];</span><br><span class="line"></span><br><span class="line">- (void)tableViewTouchInSide&#123;</span><br><span class="line">Â Â Â  <span class="comment">// ------ç»“æŸç¼–è¾‘ï¼Œéšè—é”®ç›˜</span></span><br><span class="line">Â Â Â  [<span class="keyword">self</span>.view endEditing:<span class="type">YES</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Xcode-æ ‡è®°"><a href="#Xcode-æ ‡è®°" class="headerlink" title="Xcode æ ‡è®°"></a>Xcode æ ‡è®°</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: -</span></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> -</span></span><br><span class="line"><span class="comment">// <span class="doctag">FIXME:</span> -</span></span><br></pre></td></tr></table></figure>

<h3 id="iOS-11-tableView-åˆ·æ–°è·³åŠ¨"><a href="#iOS-11-tableView-åˆ·æ–°è·³åŠ¨" class="headerlink" title="iOS 11 tableView åˆ·æ–°è·³åŠ¨"></a>iOS 11 tableView åˆ·æ–°è·³åŠ¨</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tableView.estimatedRowHeight = <span class="number">0</span>;</span><br><span class="line">tableview.estimatedSectionHeaderHeight = <span class="number">0</span>;</span><br><span class="line">tableview.estimatedSectionFooterHeight = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Xcode-æ·»åŠ é¢„ç¼–è¯‘æ–‡ä»¶"><a href="#Xcode-æ·»åŠ é¢„ç¼–è¯‘æ–‡ä»¶" class="headerlink" title="Xcode æ·»åŠ é¢„ç¼–è¯‘æ–‡ä»¶"></a>Xcode æ·»åŠ é¢„ç¼–è¯‘æ–‡ä»¶</h3><p>1ã€æ–°å»º<code>.pch</code>æ–‡ä»¶ï¼Œå‹¾é€‰target<br>2ã€<code>building setting</code>é€‰é¡¹å¡ä¸­ï¼Œæœç´¢<code>pch</code>ï¼Œæ‰¾åˆ° <code>Prefix Header</code>ï¼Œæ·»åŠ  <code>$(SRCROOT)/YourProjectName/YourPCHFileName</code></p>
<h3 id="iOSçŠ¶æ€æ æ ·å¼è®¾ç½®"><a href="#iOSçŠ¶æ€æ æ ·å¼è®¾ç½®" class="headerlink" title="iOSçŠ¶æ€æ æ ·å¼è®¾ç½®"></a>iOSçŠ¶æ€æ æ ·å¼è®¾ç½®</h3><ul>
<li>é€šè¿‡ä»£ç è®¾ç½®æ ·å¼æˆ–è€…éšè—ï¼Œå¿…é¡»è¦åœ¨<code>Info.plist</code>ä¸­æ·»åŠ å­—æ®µ<code>View controller-based status bar appearance : NO</code><br>// 1ã€é€šè¿‡åœ¨å·¥ç¨‹çš„Info.plistæ–‡ä»¶ä¸­åŠ å…¥å­—æ®µæ”¹å˜å…¨å±€æ ·å¼<br><code>UIStatusBarStyle : UIStatusBarStyleDefault/UIStatusBarStyleLightContent</code><br>// 2ã€ä»£ç å…¨å±€è®¾ç½®æ ·å¼ï¼Œé¦–å…ˆåœ¨<code>Info.plist</code>ä¸­åŠ å…¥å­—æ®µï¼Œç„¶ååœ¨<code>APPDelegate</code>ä¸­å†™ä¸‹ä»£ç <br><code>View controller-based status bar appearance : NO</code><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">UIApplication</span> sharedApplication].statusBarStyle = <span class="type">UIStatusBarStyleLightContent</span>;</span><br></pre></td></tr></table></figure></li>
<li>å•ç‹¬è®¾ç½®çŠ¶æ€æ èƒŒæ™¯é¢œè‰²<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)setStatusBarBackgroundColor:(<span class="type">UIColor</span> *)color &#123; </span><br><span class="line">    <span class="type">UIView</span> *statusBar = [[[<span class="type">UIApplication</span> sharedApplication] valueForKey:@<span class="string">"statusBarWindow"</span>] valueForKey:@<span class="string">"statusBar"</span>]; </span><br><span class="line">    <span class="keyword">if</span> ([statusBar respondsToSelector:@selector(setBackgroundColor:)])&#123;</span><br><span class="line">        statusBar.backgroundColor = color; </span><br><span class="line">        &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å›¾ç‰‡ä¸å˜å½¢æ‹‰ä¼¸"><a href="#å›¾ç‰‡ä¸å˜å½¢æ‹‰ä¼¸" class="headerlink" title="å›¾ç‰‡ä¸å˜å½¢æ‹‰ä¼¸"></a>å›¾ç‰‡ä¸å˜å½¢æ‹‰ä¼¸</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½äºiOS 5.0</span></span><br><span class="line">- (<span class="type">UIImage</span> *)stretchableImageWithLeftCapWidth:(<span class="type">NSInteger</span>)leftCapWidth topCapHeight:(<span class="type">NSInteger</span>)topCapHeight</span><br><span class="line"><span class="comment">// é«˜äºiOS 5.0</span></span><br><span class="line">- (<span class="type">UIImage</span> *)resizableImageWithCapInsets:(<span class="type">UIEdgeInsets</span>)capInsets</span><br></pre></td></tr></table></figure>
<h3 id="ä¼˜é›…åœ°é€€å‡ºApp"><a href="#ä¼˜é›…åœ°é€€å‡ºApp" class="headerlink" title="ä¼˜é›…åœ°é€€å‡ºApp"></a>ä¼˜é›…åœ°é€€å‡ºApp</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æš´åŠ›å¼ºé€€ï¼Œä¸ä¼šè°ƒç”¨applicationWillTerminateï¼Œä¼šè¢«æ‹’ç»</span></span><br><span class="line">exit(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// è‹¹æœå»ºè®®ä½¿ç”¨ï¼Œä¼šè°ƒç”¨applicationWillTerminateï¼Œä¼šè¢«æ‹’ç»</span></span><br><span class="line">abort(), <span class="built_in">assert</span>(condition);</span><br><span class="line"><span class="comment">// å‰ä¸¤ç§é€€å‡ºä¼šç»™ç”¨æˆ·é€ æˆä¸€ç§Appå´©æºƒçš„èµ¶è„šï¼Œä¸‹é¢æ¥ä¸€ä¸ªä¼˜é›…çš„æ–¹å¼ï¼Œä¼šä½¿ç”¨åˆ°ç§æœ‰æ¥å£</span></span><br><span class="line"><span class="comment">// suspend æŒ‚èµ·ç¨‹åºï¼Œä¼šç»™ç”¨æˆ·ä¸€ç§é€€å…¥åå°çš„æ„Ÿè§‰ï¼Œç„¶åå»¶æ—¶è°ƒç”¨terminateWithSuccessï¼Œç›´æ¥å¹²æ­»Appï¼Œæˆ–è€…ä½¿ç”¨ä¸Šé¢çš„æš´åŠ›æ‰‹æ®µï¼Œæˆ–è€…æ‰§è¡Œä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•</span></span><br><span class="line">[[<span class="type">UIApplication</span> sharedApplication] performSelector:@selector(suspend) withObject:<span class="literal">nil</span> afterDelay:<span class="number">0</span>];</span><br><span class="line">[[<span class="type">UIApplication</span> sharedApplication] performSelector:@selector(terminateWithSuccess) withObject:<span class="literal">nil</span> afterDelay:<span class="number">0.4</span>];</span><br></pre></td></tr></table></figure>
<h3 id="NavigationBarItemé—´è·è°ƒæ•´"><a href="#NavigationBarItemé—´è·è°ƒæ•´" class="headerlink" title="NavigationBarItemé—´è·è°ƒæ•´"></a>NavigationBarItemé—´è·è°ƒæ•´</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// iOS 11,éœ€è¦è‡ªå®šä¹‰buttonï¼Œé‡å†™AlignmentRectInsetså±æ€§</span></span><br><span class="line"><span class="type">UIButton</span> *customButton = [<span class="type">UIButton</span> buttonWithType:<span class="type">UIButtonTypeCustom</span>];</span><br><span class="line"><span class="comment">// you should do this in your own custom class</span></span><br><span class="line">customButton.overrideAlignmentRectInsets = <span class="type">UIEdgeInsetsMake</span>(<span class="number">0</span>, x, <span class="number">0</span>, -x); </span><br><span class="line">customButton.translatesAutoresizingMaskIntoConstraints = <span class="type">NO</span>;</span><br><span class="line"><span class="type">UIBarButtonItem</span> *item = [[<span class="type">UIBarButtonItem</span> alloc] initWithCustomView:customButton]</span><br><span class="line"><span class="comment">// fixed space item è°ƒæ•´é—´è·</span></span><br><span class="line"><span class="type">UIBarButtonItem</span> *positiveSeparator = [[<span class="type">UIBarButtonItem</span> alloc] initWithBarButtonSystemItem:<span class="type">UIBarButtonSystemItemFixedSpace</span> target:<span class="literal">nil</span> action:<span class="literal">nil</span>];</span><br><span class="line">positiveSeparator.width = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">self</span>.navigationItem.leftBarButtonItems = @&#123;positiveSeparator, item, ...&#125;</span><br></pre></td></tr></table></figure>
<h3 id="XCodeæ—¥å¿—è€æ˜¯è¾“å‡ºThe-connection-to-service-named-com-apple-commcenter-coretelephony-xpc-was-invalidated"><a href="#XCodeæ—¥å¿—è€æ˜¯è¾“å‡ºThe-connection-to-service-named-com-apple-commcenter-coretelephony-xpc-was-invalidated" class="headerlink" title="XCodeæ—¥å¿—è€æ˜¯è¾“å‡ºThe connection to service named com.apple.commcenter.coretelephony.xpc was invalidated"></a>XCodeæ—¥å¿—è€æ˜¯è¾“å‡ºThe connection to service named com.apple.commcenter.coretelephony.xpc was invalidated</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ç»ˆç«¯è¿è¡Œä¸‹é¢çš„å‘½ä»¤</span><br><span class="line">xcrun simctl spawn booted log config --mode "level:off"  --subsystem com.apple.CoreTelephony</span><br></pre></td></tr></table></figure>
<h3 id="iOSä¸­è·å–WIFIçš„SSID-åå­—-ï¼Œéç§æœ‰æ–¹æ³•"><a href="#iOSä¸­è·å–WIFIçš„SSID-åå­—-ï¼Œéç§æœ‰æ–¹æ³•" class="headerlink" title="iOSä¸­è·å–WIFIçš„SSID(åå­—)ï¼Œéç§æœ‰æ–¹æ³•"></a>iOSä¸­è·å–WIFIçš„SSID(åå­—)ï¼Œéç§æœ‰æ–¹æ³•</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¤´æ–‡ä»¶</span></span><br><span class="line">#<span class="keyword">import</span> &lt;SystemConfiguration/CaptiveNetwork.h&gt;</span><br><span class="line"><span class="comment">// è·å–ssid</span></span><br><span class="line">- (<span class="type">NSDictionary</span> *)fetchSSIDInfo &#123;</span><br><span class="line">    <span class="type">NSArray</span> *interfaceNames = <span class="type">CFBridgingRelease</span>(<span class="type">CFCopySupportedInterfaces</span>());</span><br><span class="line">    <span class="type">NSDictionary</span> *<span class="type">SSIDInfo</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">NSString</span> *interfaceName <span class="keyword">in</span> interfaceNames)&#123;</span><br><span class="line">        <span class="type">SSIDInfo</span> = <span class="type">CFBridgingRelease</span>(<span class="type">CNCopyCurrentNetworkInfo</span>((__bridge <span class="type">CFStringRef</span>)interfaceName));</span><br><span class="line">        <span class="type">BOOL</span> isNotEmpty = (<span class="type">SSIDInfo</span>.<span class="built_in">count</span> &gt; <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (isNotEmpty)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">SSIDInfo</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// iOS12 éœ€è¦åŠ å…¥WIFIæƒé™</span></span><br></pre></td></tr></table></figure>

</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/07/iOS-mutable-copy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="QSnowy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QSnowy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/07/iOS-mutable-copy/" class="post-title-link" itemprop="url">iOSæ·±æµ…æ‹·è´</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-12-07 00:00:00" itemprop="dateCreated datePublished" datetime="2017-12-07T00:00:00+00:00">2017-12-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-26 05:59:05" itemprop="dateModified" datetime="2020-04-26T05:59:05+00:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">iOSå¼€å‘</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åœ¨iOSå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦å¯¹æŸä¸ªå¯¹è±¡è¿›è¡Œæ‹·è´çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šç”¨<code>copy</code>å’Œ<code>mutableCopy</code>ä¸¤ç§æ–¹æ³•ï¼Œåœ¨åˆšæ¥è§¦iOSçš„æ—¶å€™ï¼Œæˆ‘ä¸€èˆ¬æŠŠ<code>copy</code>ç§°ä¸ºæµ…æ‹·è´ï¼Œ<code>mutableCopy</code>ç§°ä¸ºæ·±æ‹·è´ï¼Œä½†æ˜¯éšç€ä¸æ–­è¸©å‘ï¼Œæ‰å‘ç°å¯¹ä¸åŒç±»å‹çš„å¯¹è±¡æ‰§è¡Œæ‹·è´æ“ä½œï¼Œå¾—åˆ°çš„ç»“æœè·Ÿè‡ªå·±çš„é¢„æœŸå¹¶ä¸ä¸€è‡´ã€‚ç„¶åçœ‹äº†ç½‘ä¸Šè¯¸å¤šå…³äºæ·±æµ…æ‹·è´çš„æ–‡ç« ï¼Œå†ç»“åˆè‡ªå·±å†™ä»£ç æµ‹è¯•ï¼Œæ‰æ…¢æ…¢ç†è§£åˆ°ï¼Œå…¶å®iOSä¸­çš„æ·±æµ…æ‹·è´å¾—åˆ°çš„ç»“æœï¼Œæ˜¯è·Ÿæ‹·è´å¯¹è±¡çš„ç±»å‹æœ‰å…³ç³»çš„ã€‚</p>
<p>åœ¨iOSå¼€å‘ä¸­ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‹·è´å¯¹è±¡å¤§æ¦‚åˆ†ä¸º3ç§ï¼šéé›†åˆå¯¹è±¡ã€é›†åˆå¯¹è±¡ã€è‡ªå®šä¹‰å¯¹è±¡ã€‚å¥½äº†ï¼Œè¯ä¸å¤šè®²ï¼Œä»¥ä¸‹å°±æ˜¯é’ˆå¯¹è¿™ä¸‰ç§ä¸åŒç±»å‹å¯¹è±¡æ‰€å†™çš„æ·±æµ…æ‹·è´æµ‹è¯•ä»£ç ã€‚</p>
<h3 id="1ã€iOSä¸­éé›†åˆç±»çš„æ·±æµ…æ‹·è´"><a href="#1ã€iOSä¸­éé›†åˆç±»çš„æ·±æµ…æ‹·è´" class="headerlink" title="1ã€iOSä¸­éé›†åˆç±»çš„æ·±æµ…æ‹·è´"></a>1ã€iOSä¸­éé›†åˆç±»çš„æ·±æµ…æ‹·è´</h3><p>éé›†åˆç±»å¯¹è±¡æ·±æµ…æ‹·è´ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- (void)stringCopy&#123;</span><br><span class="line">	<span class="type">NSString</span> *str = @<span class="string">"123456"</span>;</span><br><span class="line">	<span class="comment">// å†…å®¹å†…å­˜åœ°å€ä¸å˜ï¼Œå…±ç”¨åŒä¸€å—å†…å­˜</span></span><br><span class="line">	<span class="type">NSString</span> *cpyStr = [str copy];</span><br><span class="line">	<span class="comment">// å†…å®¹åœ°å€æ”¹å˜ï¼Œå¦å¤–å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ï¼Œå†…å®¹å¯å˜</span></span><br><span class="line">	<span class="type">NSMutableString</span> *mutCpyStr = [str mutableCopy];</span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"NSStringå†…å®¹åœ°å€ï¼šstr = %p; copyStr = %p; mutStr = %p;"</span>,str,cpyStr,mutCpyStr);</span><br><span class="line">	<span class="comment">// str = 0x10e6d9068; copyStr = 0x10e6d9068; mutStr = 0x604000253f20;</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"NSstringæŒ‡é’ˆåœ°å€ï¼šstr = %p; copyStr = %p; mutStr = %p;"</span>,&amp;str,&amp;cpyStr,&amp;mutCpyStr);</span><br><span class="line">	<span class="comment">// str = 0x7fff51525be8; copyStr = 0x7fff51525be0; mutStr = 0x7fff51525bd8;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">- (void)mutableStringCopy&#123;</span><br><span class="line"></span><br><span class="line">   <span class="type">NSMutableString</span> *formatStr = [<span class="type">NSMutableString</span> stringWithFormat:@<span class="string">"å‘µå‘µå“’ğŸ™„"</span>];</span><br><span class="line">   <span class="comment">// å†…å®¹åœ°å€æ”¹å˜ï¼Œå¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ï¼Œå†…å®¹ä¸å¯å˜</span></span><br><span class="line">   <span class="type">NSString</span> *cpyStr = [formatStr copy];</span><br><span class="line">   <span class="comment">// å†…å®¹åœ°å€æ”¹å˜ï¼Œå¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ï¼Œå†…å®¹å¯å˜</span></span><br><span class="line">   <span class="type">NSMutableString</span> *mutCpyStr = [formatStr mutableCopy];</span><br><span class="line"></span><br><span class="line">   <span class="type">NSLog</span>(@<span class="string">"NSMutableStringå†…å®¹åœ°å€ï¼šstr = %p; copyStr = %p; mutStr = %p;"</span>,formatStr,cpyStr,mutCpyStr);</span><br><span class="line">   <span class="comment">// str = 0x600000249690; copyStr = 0x600000249cc0; mutStr = 0x600000249750;</span></span><br><span class="line"></span><br><span class="line">   <span class="type">NSLog</span>(@<span class="string">"NSMutableStringæŒ‡é’ˆåœ°å€ï¼šstr = %p; copyStr = %p; mutStr = %p;"</span>,&amp;formatStr,&amp;cpyStr,&amp;mutCpyStr);</span><br><span class="line">   <span class="comment">// str = 0x7fff51525be8; copyStr = 0x7fff51525be0; mutStr = 0x7fff51525bd8;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ<code>éé›†åˆå¯¹è±¡</code>çš„æ‹·è´è§„å¾‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>ä¸å¯å˜çš„éé›†åˆå¯¹è±¡<code>copy</code>ï¼ŒæŒ‡é’ˆæ‹·è´ï¼Œå…±ç”¨åŒä¸€ç‰‡å†…å­˜ï¼›</li>
<li>ä¸å¯å˜çš„éé›†åˆå¯¹è±¡<code>mutableCopy</code>ï¼Œåˆ›å»ºæ–°å†…å­˜ç©ºé—´ï¼Œæˆä¸ºå¯å˜å¯¹è±¡ã€‚</li>
<li>å¯å˜çš„éé›†åˆå¯¹è±¡<code>copy</code>ï¼Œåˆ›å»ºæ–°å†…å­˜ç©ºé—´ï¼Œæˆä¸ºä¸å¯å˜å¯¹è±¡ï¼›</li>
<li>å¯å˜çš„éé›†åˆå¯¹è±¡<code>mutableCopy</code>ï¼Œåˆ›å»ºæ–°å†…å­˜ç©ºé—´ã€‚</li>
</ul>
<h3 id="2ã€iOSä¸­é›†åˆç±»çš„æ·±æµ…æ‹·è´"><a href="#2ã€iOSä¸­é›†åˆç±»çš„æ·±æµ…æ‹·è´" class="headerlink" title="2ã€iOSä¸­é›†åˆç±»çš„æ·±æµ…æ‹·è´"></a>2ã€iOSä¸­é›†åˆç±»çš„æ·±æµ…æ‹·è´</h3><h4 id="é›†åˆç±»çš„æ‹·è´ä¸»è¦åˆ†ä¸ºä¸‹é¢ä¸‰ç§ç±»å‹ï¼š"><a href="#é›†åˆç±»çš„æ‹·è´ä¸»è¦åˆ†ä¸ºä¸‹é¢ä¸‰ç§ç±»å‹ï¼š" class="headerlink" title="é›†åˆç±»çš„æ‹·è´ä¸»è¦åˆ†ä¸ºä¸‹é¢ä¸‰ç§ç±»å‹ï¼š"></a>é›†åˆç±»çš„æ‹·è´ä¸»è¦åˆ†ä¸ºä¸‹é¢ä¸‰ç§ç±»å‹ï¼š</h4><ul>
<li>æµ…å¤åˆ¶(shallow copy)ï¼šåœ¨æµ…å¤åˆ¶æ“ä½œæ—¶ï¼Œå¯¹äºè¢«å¤åˆ¶å¯¹è±¡çš„æ¯ä¸€å±‚éƒ½æ˜¯æŒ‡é’ˆå¤åˆ¶ã€‚</li>
<li>æ·±å¤åˆ¶(one-level-deep copy)ï¼šåœ¨æ·±å¤åˆ¶æ“ä½œæ—¶ï¼Œå¯¹äºè¢«å¤åˆ¶å¯¹è±¡ï¼Œè‡³å°‘æœ‰ä¸€å±‚æ˜¯æ·±å¤åˆ¶ã€‚</li>
<li>å®Œå…¨å¤åˆ¶(real-deep copy)ï¼šåœ¨å®Œå…¨å¤åˆ¶æ“ä½œæ—¶ï¼Œå¯¹äºè¢«å¤åˆ¶å¯¹è±¡çš„æ¯ä¸€å±‚éƒ½æ˜¯å¯¹è±¡å¤åˆ¶ã€‚</li>
</ul>
<p>æ¥è‡ªè‹¹æœå®˜æ–¹çš„è§£é‡Šå›¾ä¾‹ï¼š<a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/Collections/Articles/Copying.html" target="_blank" rel="noopener" title="å®˜æ–¹é“¾æ¥">å®˜æ–¹é“¾æ¥</a><br><img src="/assets/images/CopyingCollections.png" alt=""></p>
<p>é›†åˆçš„æ·±æµ…æ‹·è´ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">- (void)collectionCopy&#123;</span><br><span class="line"></span><br><span class="line">	<span class="type">NSString</span> *str = [<span class="type">NSString</span> stringWithFormat:@<span class="string">"å‘µå‘µå“’"</span>]();</span><br><span class="line">	<span class="type">NSMutableString</span> *mutStr = [<span class="type">NSMutableString</span> stringWithFormat:@<span class="string">"èŒèŒå“’"</span>]();</span><br><span class="line">	<span class="type">NSArray</span> *arr = [<span class="type">NSArray</span> arrayWithObjects:@<span class="string">"one"</span>, @<span class="string">"two"</span>, @<span class="string">"three"</span>, <span class="literal">nil</span>]();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä¸å¯å˜é›†åˆå¯¹è±¡åªåŒ…å«éé›†åˆå¯¹è±¡</span></span><br><span class="line">	<span class="type">NSArray</span> *imutArr1 = [<span class="type">NSArray</span> arrayWithObjects:str, mutStr, <span class="literal">nil</span>]();</span><br><span class="line">	<span class="comment">// æµ…å¤åˆ¶ï¼Œåˆ›å»ºä¸€ä¸ªæŒ‡é’ˆç›´æ¥æŒ‡å‘å·²æœ‰å†…å­˜ç©ºé—´</span></span><br><span class="line">	<span class="type">NSArray</span> *cpyImutArr1 = [imutArr1 copy]();</span><br><span class="line">	<span class="comment">// æ·±å¤åˆ¶ï¼Œåˆ›å»ºæ–°çš„é›†åˆå†…å­˜ç©ºé—´ï¼Œæ–°ç“¶è£…è€é…’</span></span><br><span class="line">	<span class="type">NSMutableArray</span> *mutCpyImutArr1 = [imutArr1 mutableCopy]();</span><br><span class="line">	<span class="comment">// åˆ›å»ºæ–°çš„é›†åˆå†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”å¯¹é›†åˆå†…å…ƒç´ è¿›è¡Œ copy æ“ä½œ</span></span><br><span class="line">	<span class="type">NSMutableArray</span> *initArr1 = [\[<span class="type">NSMutableArray</span> alloc]() initWithArray:imutArr1 copyItems:<span class="type">YES</span>];</span><br><span class="line">	<span class="comment">// å®Œå…¨æ·±å¤åˆ¶ï¼Œå¦‚æœå…ƒç´ æ˜¯è‡ªå®šä¹‰ç±»å‹ï¼Œéœ€è¦å®ç°NSCodingåè®®</span></span><br><span class="line">	<span class="type">NSArray</span> *deepCpyArr1 = [<span class="type">NSKeyedUnarchiver</span> unarchiveObjectWithData:\[<span class="type">NSKeyedArchiver</span> archivedDataWithRootObject:imutArr1]()];</span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n imutArr1 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;imutArr1, imutArr1, imutArr1[<span class="number">0</span>](), imutArr1[<span class="number">1</span>](), imutArr1[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// imutArr1 info : pointer = 0x7fff5d946bc8; content = 0x604000443960; first = 0x604000037520; second = 0x604000442d30; third = 0x6040004446e0</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n cpyImutArr1 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;cpyImutArr1, cpyImutArr1, cpyImutArr1[<span class="number">0</span>](), cpyImutArr1[<span class="number">1</span>](), cpyImutArr1[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// cpyImutArr1 info : pointer = 0x7fff5d946bc0; content = 0x604000443960; first = 0x604000037520; second = 0x604000442d30; third = 0x6040004446e0</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n mutCpyImutArr1 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;mutCpyImutArr1, mutCpyImutArr1, mutCpyImutArr1[<span class="number">0</span>](), mutCpyImutArr1[<span class="number">1</span>](), mutCpyImutArr1[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// mutCpyImutArr1 info : pointer = 0x7fff5d946bb8; content = 0x604000444290; first = 0x604000037520; second = 0x604000442d30; third = 0x6040004446e0</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n initArr1 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;initArr1, initArr1, initArr1[<span class="number">0</span>](), initArr1[<span class="number">1</span>](), initArr1[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// initArr1 info : pointer = 0x7fff5d946bb0; content = 0x604000442e80; first = 0x604000037520; second = 0x604000231aa0; third = 0x6040004446e0</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n deepCpyArr1 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;deepCpyArr1, deepCpyArr1, deepCpyArr1[<span class="number">0</span>](), deepCpyArr1[<span class="number">1</span>](), deepCpyArr1[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// deepCpyArr1 info : pointer = 0x7fff5d946ba8; content = 0x604000443210; first = 0x604000231ce0; second = 0x604000444710; third = 0x6040004441d0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// å¯å˜é›†åˆå¯¹è±¡åŒ…å«é›†åˆå¯¹è±¡</span></span><br><span class="line">	<span class="type">NSMutableArray</span> *mutArr2 = [<span class="type">NSMutableArray</span> arrayWithObjects:str, mutStr, arr, <span class="literal">nil</span>]();</span><br><span class="line">	<span class="comment">// æ·±å¤åˆ¶ï¼Œåˆ›å»ºæ–°çš„é›†åˆå†…å­˜ç©ºé—´ï¼Œå†…å®¹ä¸å˜ï¼Œæ–°çš„é›†åˆä¸å¯å˜</span></span><br><span class="line">	<span class="type">NSMutableArray</span> *cpyMutArr2 = [mutArr2 copy]();</span><br><span class="line">	<span class="comment">// æ·±å¤åˆ¶ï¼Œåˆ›å»ºæ–°çš„é›†åˆå†…å­˜ç©ºé—´ï¼Œå†…å®¹ä¸å˜</span></span><br><span class="line">	<span class="type">NSMutableArray</span> *mutCpyMutArr2 = [mutArr2 mutableCopy]();</span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n mutArr2 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;mutArr2, mutArr2, mutArr2[<span class="number">0</span>](), mutArr2[<span class="number">1</span>](), mutArr2[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// mutArr2 info : pointer = 0x7fff53507bc8; content = 0x60400025e2a0; first = 0x60400023fa40; second = 0x60400025d2b0; third = 0x60400025f710</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n cpyMutArr2 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;cpyMutArr2, cpyMutArr2, cpyMutArr2[<span class="number">0</span>](), cpyMutArr2[<span class="number">1</span>](), cpyMutArr2[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// cpyMutArr2 info : pointer = 0x7fff53507bc0; content = 0x60400025d760; first = 0x60400023fa40; second = 0x60400025d2b0; third = 0x60400025f710</span></span><br><span class="line"></span><br><span class="line">	<span class="type">NSLog</span>(@<span class="string">"\n mutCpyImutArr1 info : pointer = %p; content = %p; first = %p; second = %p; third = %p"</span>,&amp;mutCpyMutArr2, mutCpyMutArr2, mutCpyMutArr2[<span class="number">0</span>](), mutCpyMutArr2[<span class="number">1</span>](), mutCpyMutArr2[<span class="number">2</span>]());</span><br><span class="line">	<span class="comment">// mutCpyImutArr1 info : pointer = 0x7fff53507bb8; content = 0x60400025d310; first = 0x60400023fa40; second = 0x60400025d2b0; third = 0x60400025f710</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä»£ç å’Œæ—¥å¿—å¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li><code>ä¸å¯å˜é›†åˆ</code>çš„æ‹·è´è§„å¾‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</li>
</ul>
<p><code>[immutableObject copy]</code> <strong>æµ…å¤åˆ¶ï¼ŒæŒ‡é’ˆå¤åˆ¶</strong></p>
<p><code>[immutableObject mutableCopy]</code> <strong>æ·±å¤åˆ¶ï¼Œä¸æ˜¯å®Œå…¨å¤åˆ¶ï¼Œå®¹å™¨æ˜¯æ–°çš„å¯å˜å®¹å™¨ï¼Œå†…å®¹è¿˜æ˜¯æ—§çš„</strong></p>
<ul>
<li><code>å¯å˜é›†åˆ</code>çš„æ‹·è´è§„å¾‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</li>
</ul>
<p><code>[mutableObject copy]</code> <strong>æ·±å¤åˆ¶ è¿”å›å¯¹è±¡ä¸ºimmutable</strong></p>
<p><code>[mutableObject mutableCopy]</code> <strong>æ·±å¤åˆ¶ï¼Œä¸æ˜¯å®Œå…¨å¤åˆ¶ï¼Œå®¹å™¨æ˜¯æ–°çš„å¯å˜å®¹å™¨ï¼Œå†…å®¹è¿˜æ˜¯æ—§çš„</strong></p>
<p>è‹¥æƒ³è¦å®ç°å®Œå…¨æ‹·è´ï¼Œåˆ™éœ€è¦ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSArray</span> *newArr = [<span class="type">NSKeyedUnarchiver</span> unarchiveObjectWithData:[<span class="type">NSKeyedArchiver</span> archivedDataWithRootObject:oldArr]];</span><br></pre></td></tr></table></figure>

<p>è‡³äºæ‹·è´åçš„é›†åˆæ˜¯å¦å¯å˜ï¼Œåˆ™è·Ÿæ—§é›†åˆçš„æ˜¯å¦å¯å˜ä¸€è‡´ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœé›†åˆå†…å«æœ‰è‡ªå®šä¹‰çš„ç±»å¯¹è±¡ï¼Œåˆ™è¯¥ç±»éœ€è¦å®ç° <code>NSCoding</code> åè®®ã€‚</p>
<p>å¦‚æœæ ¹æ®é›†åˆé‡æ–°<code>init</code>ä¸€ä¸ªæ–°çš„é›†åˆå‡ºæ¥ï¼Œå°±åƒè¿™æ ·å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSMutableArray</span> *newArr = [[<span class="type">NSMutableArray</span> alloc] initWithArray:arr copyItems:<span class="type">YES</span>];</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆç”Ÿæˆçš„æ–°é›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸ä¸€å®šéƒ½æ˜¯å®Œå…¨æ‹·è´çš„ã€‚å› ä¸ºæ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œåªä¼šå¯¹é›†åˆå†…çš„å…ƒç´ æ‰§è¡Œ <code>copy</code>æ–¹æ³•ã€‚</p>
<h3 id="3ã€iOSä¸­è‡ªå®šä¹‰å¯¹è±¡çš„æ·±æµ…æ‹·è´"><a href="#3ã€iOSä¸­è‡ªå®šä¹‰å¯¹è±¡çš„æ·±æµ…æ‹·è´" class="headerlink" title="3ã€iOSä¸­è‡ªå®šä¹‰å¯¹è±¡çš„æ·±æµ…æ‹·è´"></a>3ã€iOSä¸­è‡ªå®šä¹‰å¯¹è±¡çš„æ·±æµ…æ‹·è´</h3><p>iOSä¸­è‡ªå®šä¹‰å¯¹è±¡è¦æƒ³å®ç°æ‹·è´ï¼Œå¿…é¡»è¦å®ç°<code>NSCopying</code>æˆ–è€…<code>NSMutableCopying</code>åè®®ã€‚<br>è‡ªå®šä¹‰å¯¹è±¡å®ç°æ‹·è´ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cat.h</span></span><br><span class="line"># <span class="keyword">import</span> &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">@interface <span class="type">Cat</span> : <span class="type">NSObject</span> &lt;<span class="type">NSCopying</span>, <span class="type">NSMutableCopying</span>&gt;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, assign) <span class="type">NSUInteger</span> age;</span><br><span class="line">@property (nonatomic, copy) <span class="type">NSString</span> *name;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cat.m</span></span><br><span class="line"># <span class="keyword">import</span> "Cat.h"</span><br><span class="line"></span><br><span class="line">@implementation <span class="type">Cat</span></span><br><span class="line"></span><br><span class="line">- (instancetype)copyWithZone:(<span class="type">NSZone</span> *)zone&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)mutableCopyWithZone:(<span class="type">NSZone</span> *)zone&#123;</span><br><span class="line"></span><br><span class="line">	<span class="type">Cat</span> *cat = [[<span class="type">Cat</span> alloc] <span class="keyword">init</span>];</span><br><span class="line">	cat.name = @<span class="string">"hello"</span>;</span><br><span class="line">	<span class="keyword">return</span> cat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p>ä»ä»£ç å¯ä»¥çœ‹å‡ºï¼Œè‡ªå®šä¹‰ç±»è¦éµå®ˆ<code>NSCopy</code>åè®®æˆ–è€…<code>NSMutableCopy</code>åè®®ï¼Œæ‹·è´åè®®çš„ä»£ç ç”±è‡ªå·±æ¥å®ç°ï¼Œé‚£ä¹ˆè‡ªå®šä¹‰ç±»å¯¹è±¡æ‰§è¡Œ<code>copy</code>æˆ–è€…<code>mutableCopy</code>æ‰€å¾—çš„ç»“æœï¼Œæ— è®ºæ˜¯æŒ‡é’ˆå±‚é¢çš„æµ…æ‹·è´ï¼Œè¿˜æ˜¯å®Œå…¨æ‹·è´ï¼Œéƒ½æ˜¯ç”±è‡ªå·±æ¥å†³å®šçš„ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœé›†åˆé‡Œé¢åŒ…å«äº†è‡ªå®šä¹‰ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆè¦ç”¨<code>NSKeyedArchiver/NSKeyedUnarchiver</code>å®ç°é›†åˆçš„å®Œå…¨æ‹·è´ï¼Œåˆ™éœ€è¦è‡ªå®šä¹‰ç±»å®ç°<code>NSCoding</code>åè®®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (id)initWithCoder:(<span class="type">NSCoder</span> *)aDecoder&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">self</span> = [<span class="keyword">super</span> <span class="keyword">init</span>];</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">self</span> == <span class="literal">nil</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">self</span>.name = [aDecoder decodeObjectForKey:@<span class="string">"name"</span>];</span><br><span class="line">	<span class="comment">// ä¾æ¬¡å†™ä¸‹æƒ³è¦decodeçš„å±æ€§</span></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)encodeWithCoder:(<span class="type">NSCoder</span> *)aCoder&#123;</span><br><span class="line"></span><br><span class="line">	[aCoder encodeObject:<span class="keyword">self</span>.name forKey:@<span class="string">"name"</span>];</span><br><span class="line">	<span class="comment">// ä¾æ¬¡å†™ä¸‹æƒ³è¦encodeçš„å±æ€§</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="QSnowy"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">QSnowy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">åˆ†ç±»</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">QSnowy</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
